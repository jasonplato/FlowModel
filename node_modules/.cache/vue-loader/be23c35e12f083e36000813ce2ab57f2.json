{"remainingRequest":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangxufei/Desktop/FlowModel/src/components/create/LineChart.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/wangxufei/Desktop/FlowModel/src/components/create/LineChart.vue","mtime":1652163070442},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYm94IHsKICBwYWRkaW5nOiA1cHg7CiAgLmF0dHItc2VsZWN0IHsKICAgIHNwYW4gewogICAgICBtYXJnaW4tcmlnaHQ6IDVweDsKICAgICAgZm9udC1zaXplOiAxNHB4OwogICAgICBmb250LXdlaWdodDogNjAwOwogICAgfQogIH0KICAubGluZUNoYXJ0IHsKICAgIG1hcmdpbi10b3A6IDMwcHg7CiAgfQogIC5lbXB0eS1ib3ggewogICAgaGVpZ2h0OiA1NDZweDsKICB9Cn0KLnNob3cgewogIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKfQo="},{"version":3,"sources":["LineChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"LineChart.vue","sourceRoot":"src/components/create","sourcesContent":["<template>\n  <div class=\"box\">\n    <div v-bind:class=\"{ show: chartShow }\">\n      <div class=\"attr-select\">\n        <el-dropdown @command=\"handleCommand\">\n          <span class=\"el-dropdown-link\">\n            {{ this.selectToken }}\n            <i class=\"el-icon-arrow-down el-icon--right\"></i>\n          </span>\n          <el-dropdown-menu slot=\"dropdown\">\n            <el-dropdown-item\n              v-for=\"item in tokenType\"\n              :key=\"item\"\n              :command=\"item\"\n              >{{ item }}</el-dropdown-item\n            >\n          </el-dropdown-menu>\n        </el-dropdown>\n      </div>\n      <div id=\"lineChart\" ref=\"lineChart\" class=\"lineChart\"></div>\n    </div>\n    <!-- 空状态时显示 -->\n    <el-empty\n      description=\"Please select data first!\"\n      class=\"empty-box\"\n      v-bind:class=\"{ show: !chartShow }\"\n    ></el-empty>\n  </div>\n</template>\n \n<script>\nimport { Line } from \"@antv/g2plot\";\nexport default {\n  name: \"lineChart\",\n  props: {\n    linedata: {\n      type: Array,\n      default() {\n        return [];\n      },\n    },\n    Height: {\n      type: Number,\n      default: 500,\n    },\n    Width: {\n      type: Number,\n      default: 700,\n    },\n    xField: {\n      type: String,\n      default: \"time\",\n    },\n    yField: {\n      type: String,\n      default: \"value\",\n    },\n    category: {\n      type: String,\n      default: \"category\",\n    },\n  },\n  data() {\n    return {\n      alreadyRender: false,\n      LinePlot: null,\n      tokenType: [],\n      selectToken: null,\n      chartShow: true,\n    };\n  },\n  mounted() {\n    this.initG2Plot();\n  },\n  methods: {\n    handleCommand(command) {\n      let selectData = [];\n      this.selectToken = command;\n      //如果未选数据则渲染为空\n      if (this.linedata.length == 0) {\n        this.LinePlot.changeData([]);\n      } else {\n        //根据所选择的token类别便利对应的历史数据\n        this.linedata.forEach((item) => {\n          item.data.forEach((element) => {\n            if (element.type == command) {\n              element.data.forEach((metaData) => {\n                metaData.data.forEach((row) => {\n                  selectData.push({\n                    category: item.category + \"-\" + metaData.type,\n                    time: row.time,\n                    value: row.value,\n                  });\n                });\n              });\n            }\n          });\n        });\n      }\n      //如果从未渲染过则渲染\n      if (!this.alreadyRender) {\n        this.LinePlot.render();\n      }\n      //否则直接更新数据\n      this.LinePlot.changeData(selectData);\n    },\n\n    /**\n     * chart图表初始化\n     * 需要根据后期的数据动态修改其中的x，y字段\n     */\n    initG2Plot() {\n      this.LinePlot = new Line(this.$refs.lineChart, {\n        data: this.linedata,\n        height: this.Height,\n        width: this.Width,\n        xField: this.xField,\n        yField: this.yField,\n        seriesField: this.category,\n        smooth: true,\n\n        yAxis: {\n          label: {\n            // 数值格式化为千分位\n            formatter: (v) =>\n              `${v}`.replace(/\\d{1,3}(?=(\\d{3})+$)/g, (s) => `${s},`),\n          },\n          grid: {\n            line: {\n              style: {\n                stroke: \"black\",\n                lineWidth: 0.2,\n                lineDash: [4, 5],\n                strokeOpacity: 0.7,\n                shadowColor: \"black\",\n                shadowBlur: 10,\n                shadowOffsetX: 5,\n                shadowOffsetY: 5,\n                cursor: \"pointer\",\n              },\n            },\n          },\n        },\n      });\n      if (this.linedata.length != 0) {\n        this.LinePlot.render();\n      }\n    },\n  },\n  watch: {\n    /**\n     * 监听对应数据字段，当数据发生变化时重新渲染\n     */\n    linedata: {\n      handler() {\n        this.tokenType = [];\n        if (this.linedata.length != 0) {\n          this.chartShow = false;\n          this.linedata[0].data.forEach((element) => {\n            this.tokenType.push(element.type);\n          });\n          //当被选择数据不为空时，且曾经未选择过，直接使用第一个token字段作为展示\n          if (this.selectToken == null) {\n            this.handleCommand(this.tokenType[0]);\n            this.selectToken = this.tokenType[0];\n          } else {\n            this.handleCommand(this.selectToken);\n          }\n        } else {\n          this.chartShow = true;\n        }\n      },\n      deep: true,\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.box {\n  padding: 5px;\n  .attr-select {\n    span {\n      margin-right: 5px;\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n  .lineChart {\n    margin-top: 30px;\n  }\n  .empty-box {\n    height: 546px;\n  }\n}\n.show {\n  display: none !important;\n}\n</style>"]}]}