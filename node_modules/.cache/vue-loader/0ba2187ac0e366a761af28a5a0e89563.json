{"remainingRequest":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangxufei/Desktop/FlowModel/src/components/create/ToolsNavbar.vue?vue&type=style&index=0&id=83ae51b0&lang=scss&scoped=true&","dependencies":[{"path":"/Users/wangxufei/Desktop/FlowModel/src/components/create/ToolsNavbar.vue","mtime":1652163070441},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouZWwtZHJvcGRvd24tbWVudSB7CiAgLmVsLWRyb3Bkb3duLW1lbnVfX2l0ZW0gewogICAgLmVsLWJ1dHRvbiB7CiAgICAgIGNvbG9yOiAjNTU1NTU1OwogICAgICBmb250LXNpemU6IDE1cHg7CiAgICB9CiAgICAmOmhvdmVyIHsKICAgICAgY29sb3I6ICM1NTU1NTU7CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNlY2ViZWI7CiAgICB9CiAgfQp9Ci50b3AtY29udGFpbmVyIHsKICBoZWlnaHQ6IDUwcHg7Cn0KLnRvcCB7CiAgcG9zaXRpb246IGZpeGVkOwogIC8vei1pbmRleDogMjAwMDsKICBib3R0b206IDgwcHg7CiAgbGVmdDogMTglOwogIHJpZ2h0OiAyMiU7CiAgLy8gb3ZlcmZsb3cteDogc2Nyb2xsOwogIGxpbmUtaGVpZ2h0OiA1MHB4OwogIGhlaWdodDogNTBweDsKICB3aWR0aDogNzglOwoKICBmb250LWZhbWlseTogIlRpbWVzIE5ldyBSb21hbiIsIEdlb3JnaWEsIFNlcmlmOwogIGZvbnQtc2l6ZTogMTRweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOwogIGJvcmRlci1yYWRpdXM6IDIwcHg7CiAgYm94LXNoYWRvdzogMCAwIDJweCByZ2JhKDE4MCwgMTgwLCAxODAsIDAuOCk7CgogIC50b29sLWJhciB7CiAgICBmbG9hdDogbGVmdDsKICAgIG1hcmdpbi1sZWZ0OiAxNXB4OwogICAgd2lkdGg6IDM4MHB4OwogICAgYm9yZGVyLXJhZGl1czogMjBweDsKICAgIC8vIGJveC1zaGFkb3c6IDAgMCAycHggcmdiYSgxODAsIDE4MCwgMTgwLCAwLjgpOwoKICAgIGkgewogICAgICBtYXJnaW46IDBweCAxMHB4OwogICAgICBmb250LXNpemU6IDE4cHg7CiAgICAgIGNvbG9yOiAjNTU1NTU1OwogICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAmOmhvdmVyIHsKICAgICAgICAvLyBjb2xvcjogIzlhOWE5YzsKICAgICAgICBjb2xvcjogIzQwOWVmZjsKICAgICAgfQogICAgfQogIH0KICAuY29uZmlnLWRhdGEtYm94IHsKICAgIGZsb2F0OiBsZWZ0OwogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgc3BhbiB7CiAgICAgIG1hcmdpbi1sZWZ0OiAycHg7CiAgICB9CiAgICAuY29uZmlnLWRhdGEtaW5wdXQgewogICAgICBmbG9hdDogbGVmdDsKICAgICAgd2lkdGg6IDEwMHB4OwogICAgICBtYXJnaW4tbGVmdDogMjBweDsKICAgIH0KICAgIC5kaXZpZGVyIHsKICAgICAgbWFyZ2luLWxlZnQ6IDI1cHg7CiAgICB9CiAgICAuZGF5LXNsaWRlciB7CiAgICAgIGZsb2F0OiBsZWZ0OwogICAgICBtYXJnaW46IDdweCAwcHggMHB4IDE1cHg7CiAgICAgIHdpZHRoOiAyODBweDsKICAgICAgL2RlZXAvIC5lbC1zbGlkZXJfX2JhciB7CiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoOTQsIDkxLCA5MSk7CiAgICAgICAgfQogICAgICAgIC9kZWVwLyAuZWwtc2xpZGVyX19idXR0b24gewogICAgICAgICAgYm9yZGVyOiAycHggc29saWQgcmdiKDk0LCA5MSwgOTEpOwogICAgICAgICAgdHJhbnNpdGlvbjogMHM7CiAgICAgICAgfQogICAgfQogICAgLnRpbWVyIHsKICAgICAgZmxvYXQ6IGxlZnQ7CgogICAgICAvLyBtYXJnaW46IDdweCAwcHggMHB4IDE1cHg7CgogICAgICB3aWR0aDogMjBweDsKICAgIH0KICB9CiAgLmNvbmZpZy1idXR0b24gewogICAgZmxvYXQ6IHJpZ2h0OwogICAgbWFyZ2luLXJpZ2h0OiA2MHB4OwogICAgLmxvZy1pbiB7CiAgICAgIGZsb2F0OiBsZWZ0OwogICAgICBtYXJnaW4tcmlnaHQ6IDEwcHg7CiAgICAgIC5kcm9wZG93bi1pY29uIHsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgZm9udC1zaXplOiAyNXB4OwogICAgICAgIGZsb2F0OiBsZWZ0OwogICAgICAgIGNvbG9yOiByZ2IoOTksIDk5LCA5OSk7CiAgICAgICAgJjpob3ZlciB7CiAgICAgICAgICBjb2xvcjogI2EzYTNhMzsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC5zZXR0aW5nIHsKICAgICAgZm9udC1zaXplOiAyNXB4OwogICAgICBmbG9hdDogcmlnaHQ7CiAgICAgIG1hcmdpbi1yaWdodDogMjAwcHg7CiAgICAgIGNvbG9yOiByZ2IoOTksIDk5LCA5OSk7CiAgICAgICY6aG92ZXIgewogICAgICAgIGNvbG9yOiAjYTNhM2EzOwogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["ToolsNavbar.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ToolsNavbar.vue","sourceRoot":"src/components/create","sourcesContent":["<template >\n  <div class=\"top-container\">\n    <div class=\"top\">\n      <!-- 工具栏 -->\n      <div class=\"tool-bar\">\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Enlarge\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"ZOOM_GRAPH('up')\" class=\"el-icon-zoom-in\"></i>\n        </el-tooltip>\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Lessen\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"ZOOM_GRAPH('down')\" class=\"el-icon-zoom-out\"></i>\n        </el-tooltip>\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Undo operation\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"UNDO_GRAPH()\" class=\"el-icon-back\"></i>\n        </el-tooltip>\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Redo operation\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"REDO_GRAPH()\" class=\"el-icon-right\"></i>\n        </el-tooltip>\n\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Start simulation\"\n          placement=\"bottom\"\n          effect=\"light\"\n          v-if=\"nowait\"\n        >\n          <i @click=\"startSimulation()\" class=\"el-icon-video-play\"></i>\n        </el-tooltip>\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Start simulation\"\n          placement=\"bottom\"\n          effect=\"light\"\n          v-else\n        >\n          <i class=\"el-icon-loading\"></i>\n        </el-tooltip>\n\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Pause simulation\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"pauseSimulation()\" class=\"el-icon-video-pause\"></i>\n        </el-tooltip>\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"End simulation\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"endSimulation()\" class=\"el-icon-circle-close\"></i>\n        </el-tooltip>\n        <!-- <el-tooltip\n          class=\"tooltip\"\n          content=\"Upload existing models\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"uploadGraph()\" class=\"el-icon-upload2\"></i>\n        </el-tooltip> -->\n        <!-- <el-tooltip\n          class=\"tooltip\"\n          content=\"Download model\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"downloadGraph()\" class=\"el-icon-download\"></i>\n        </el-tooltip> -->\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Download model\"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"saveGraphToPNG()\" class=\"el-icon-camera-solid\"></i>\n        </el-tooltip>\n\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Remove cells \"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"REMOVE_CELLS()\" class=\"el-icon-delete\"></i>\n        </el-tooltip>\n\n        <el-tooltip\n          class=\"tooltip\"\n          content=\"Focus canvas \"\n          placement=\"bottom\"\n          effect=\"light\"\n        >\n          <i @click=\"POSITIONING_GRAPH()\" class=\"el-icon-full-screen\"></i>\n        </el-tooltip>\n      </div>\n      <!-- 系统参数栏 -->\n      <div class=\"config-data-box\">\n        <!-- <span>Simulation Days</span> -->\n\n        <!-- <el-input\n          size=\"mini\"\n          class=\"config-data-input\"\n          v-model=\"currentSimulationDays\"\n          placeholder=\"\"\n          :disabled=\"modifyDisabled\"\n        ></el-input> -->\n\n        <span class=\"config-data-input\">Simulation Days</span>\n        <el-slider\n          v-model=\"configData.simulationDays\"\n          class=\"day-slider\"\n          :min=\"1\"\n          :max=\"5000\"\n          :step=\"1\"\n          :change=\"modifyConfigData()\"\n        ></el-slider>\n        <span class=\"config-data-input\">Simulation Slot</span>\n        <el-slider\n          v-model=\"configData.simulationSlot\"\n          class=\"day-slider\"\n          :min=\"1\"\n          :max=\"365\"\n          :step=\"1\"\n          :change=\"modifyConfigData()\"\n        ></el-slider>\n        <span class=\"config-data-input\">Current Day: </span>\n        <span v-text=\"getModelTime()\"></span>\n\n        <!-- <div class=\"config-data-input\">Current Day\n          <div v-text=\"getModelTime()\"></div>\n        </div> -->\n      </div>\n      <!-- 系统参数修改按钮 -->\n      <!-- <div class=\"config-button\">\n        <div class=\"setting\">\n          <i\n            class=\"el-icon-setting\"\n            @click=\"modifyDisabled = !modifyDisabled\"\n            v-if=\"modifyDisabled\"\n          ></i>\n          <i\n            class=\"el-icon-success\"\n            @click=\"modifyConfigData()\"\n            v-if=\"!modifyDisabled\"\n          ></i>\n        </div>\n      </div> -->\n    </div>\n  </div>\n</template>\n<script>\nimport { mapState, mapMutations } from \"vuex\";\nimport { Model } from \"../../graph/model\";\nimport { floor } from \"mathjs\";\nimport { DataUri } from \"@antv/x6\";\nimport { setStore } from \"../../utils/storage\";\nexport default {\n  data() {\n    return {\n      currentSimulationDays: null,\n      currentSimulationSlot: null,\n      modifyDisabled: true,\n      dialogLogInVisible: false,\n      nowait: true,\n    };\n  },\n  components: {},\n  methods: {\n    ...mapMutations([\n      \"ZOOM_GRAPH\",\n      \"POSITIONING_GRAPH\",\n      \"UNDO_GRAPH\",\n      \"REDO_GRAPH\",\n      \"MODIFY_CONFIGDATA\",\n      \"LOAD_CONFIGDATA\",\n      \"SHOW_UPLOAD_DIALOG\",\n      \"SET_MODEL\",\n      \"REMOVE_CELLS\",\n      \"APPEND_HISTORY_SIMULATE_DATA\",\n      \"SET_HISTORY_SIMULATE_DATA\",\n      \"SET_NONCE\",\n    ]),\n    formatTooltip(val) {\n      return val / 100;\n    },\n    /**\n    修改全局配置信息\n     */\n    modifyConfigData() {\n      setStore(\"config_data\", this.configData);\n    },\n\n    /**\n    下载当前模型为json文件\n     */\n    downloadGraph() {\n      //获取时间戳\n      var timestamp = new Date().valueOf();\n      //将全局配置信息和画布数据封装成对象\n      let modelData = {\n        model: { configData: this.configData, graph: this.graph },\n      };\n      const filename = \"Model\" + timestamp + \".json\";\n      const data = JSON.stringify(modelData, undefined, 4);\n      let blob = new Blob([data], { type: \"text/json\" }),\n        a = document.createElement(\"a\");\n      a.download = filename;\n      a.href = window.URL.createObjectURL(blob);\n      // 标签 data- 嵌入自定义属性  屏蔽后也可正常下载\n      a.dataset.downloadurl = [\"text/json\", a.download, a.href].join(\":\");\n      // 添加鼠标事件\n      let event = new MouseEvent(\"click\", {});\n      // 向一个指定的事件目标派发一个事件\n      a.dispatchEvent(event);\n    },\n    /**\n    上传已有的模型，json文件\n     */\n    uploadGraph() {\n      this.SHOW_UPLOAD_DIALOG();\n    },\n    /*\n    开始测算\n    */\n    async startSimulation() {\n      // 测算开始，开启 loading 图标\n      this.nowait = false;\n\n      // 模型初次测算时\n      if (this.model == null) {\n        console.log(\n          \"starting simulation...\",\n          this.configData.simulationDays,\n          \"days\",\n          \" with control slot:\",\n          this.configData.simulationSlot,\n          \"days\"\n        );\n        var model = new Model(\n          this.graph,\n          this.configData.simulationDays,\n          this.configData.simulationSlot\n        );\n\n        this.SET_MODEL(model);\n\n        this.APPEND_HISTORY_SIMULATE_DATA({\n          type: this.nonce,\n          data: this.model.data,\n        });\n      } else {\n        // TODO [Done] 模型已经存在时，其相关参数需要根据画布上的最新状态来更新\n        this.model.selfUpdate(\n          this.graph,\n          this.configData.simulationDays,\n          this.configData.simulationSlot\n        );\n      }\n      // 设置 model 的状态为 1 - 正在测算中\n      this.model.status = 1;\n      await this.model.start();\n\n      // 测算终止（正常终止 / 暂停终止）时更新测算历史数据\n      this.SET_HISTORY_SIMULATE_DATA(this.nocne, this.model.data);\n\n      if (this.model.status != 2) {\n        // 当模型处于非 Pause 状态时\n        console.log(\"the simulation is ended\");\n      }\n\n      //  测算终止（正常终止 / 暂停终止），关闭 loading 图标\n      this.nowait = true;\n    },\n    /*\n    暂停测算\n    */\n    pauseSimulation() {\n      // TODO 处于暂停状态中，画布上的某些不可改的参数应该置为灰色或不可选(不可新建、删除节点；不可更改的参数如)\n\n      // 测算暂停，关闭 loading 图标\n      this.nowait = true;\n\n      console.log(\"pausing simulation...\");\n      if (this.model == null) {\n        console.log(\"there's no model running!\");\n      } else {\n        // 修改模型的状态为 2 - 暂停\n        this.model.status = 2;\n        console.log(\n          \"The model is paused. \",\n          \"You can only adjust params on existing model. \",\n          \"If you need to adjust the architecture of model, please END current simulation first\"\n        );\n      }\n    },\n    /*\n    结束当前测算\n    */\n    endSimulation() {\n      // 测算暂停，关闭 loading 图标\n      this.nowait = true;\n      console.log(\"ending simulation...\");\n      // 修改模型的状态为 0 - 停止\n      this.model.status = 0;\n      // 将当前模型置为 null\n      this.SET_MODEL(null);\n      console.log(\"the simulation is ended\");\n      // 当前测算结束后，将记录历史数据次数的 nonce 值增加 1\n      this.SET_NONCE(this.nonce + 1);\n    },\n    /**\n     * 下载模型图片\n     */\n    saveGraphToPNG() {\n      this.graph.toPNG(\n        (dataUri) => {\n          // 下载\n          DataUri.downloadDataUri(dataUri, \"chart.png\");\n        },\n        {\n          padding: {\n            top: 20,\n            right: 20,\n            bottom: 20,\n            left: 20,\n          },\n        }\n      );\n    },\n    /**\n     * 获取模型测算进行中的时间\n     */\n    getModelTime() {\n      if (this.model == null) return 0;\n      return this.model.curDay;\n    },\n  },\n  computed: {\n    ...mapState([\"configData\", \"graph\", \"model\", \"nonce\"]),\n  },\n  mounted() {},\n};\n</script>\n<style lang=\"scss\" scoped>\n.el-dropdown-menu {\n  .el-dropdown-menu__item {\n    .el-button {\n      color: #555555;\n      font-size: 15px;\n    }\n    &:hover {\n      color: #555555;\n      background-color: #ecebeb;\n    }\n  }\n}\n.top-container {\n  height: 50px;\n}\n.top {\n  position: fixed;\n  //z-index: 2000;\n  bottom: 80px;\n  left: 18%;\n  right: 22%;\n  // overflow-x: scroll;\n  line-height: 50px;\n  height: 50px;\n  width: 78%;\n\n  font-family: \"Times New Roman\", Georgia, Serif;\n  font-size: 14px;\n  background-color: #ffffff;\n  border-radius: 20px;\n  box-shadow: 0 0 2px rgba(180, 180, 180, 0.8);\n\n  .tool-bar {\n    float: left;\n    margin-left: 15px;\n    width: 380px;\n    border-radius: 20px;\n    // box-shadow: 0 0 2px rgba(180, 180, 180, 0.8);\n\n    i {\n      margin: 0px 10px;\n      font-size: 18px;\n      color: #555555;\n      font-weight: bold;\n      cursor: pointer;\n      &:hover {\n        // color: #9a9a9c;\n        color: #409eff;\n      }\n    }\n  }\n  .config-data-box {\n    float: left;\n    text-align: center;\n    span {\n      margin-left: 2px;\n    }\n    .config-data-input {\n      float: left;\n      width: 100px;\n      margin-left: 20px;\n    }\n    .divider {\n      margin-left: 25px;\n    }\n    .day-slider {\n      float: left;\n      margin: 7px 0px 0px 15px;\n      width: 280px;\n      /deep/ .el-slider__bar {\n          background-color: rgb(94, 91, 91);\n        }\n        /deep/ .el-slider__button {\n          border: 2px solid rgb(94, 91, 91);\n          transition: 0s;\n        }\n    }\n    .timer {\n      float: left;\n\n      // margin: 7px 0px 0px 15px;\n\n      width: 20px;\n    }\n  }\n  .config-button {\n    float: right;\n    margin-right: 60px;\n    .log-in {\n      float: left;\n      margin-right: 10px;\n      .dropdown-icon {\n        cursor: pointer;\n        font-size: 25px;\n        float: left;\n        color: rgb(99, 99, 99);\n        &:hover {\n          color: #a3a3a3;\n        }\n      }\n    }\n    .setting {\n      font-size: 25px;\n      float: right;\n      margin-right: 200px;\n      color: rgb(99, 99, 99);\n      &:hover {\n        color: #a3a3a3;\n      }\n    }\n  }\n}\n</style>"]}]}