{"remainingRequest":"/Users/xufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js!/Users/xufei/Desktop/FlowModel/node_modules/eslint-loader/index.js??ref--13-0!/Users/xufei/Desktop/FlowModel/src/graph/token.js","dependencies":[{"path":"/Users/xufei/Desktop/FlowModel/src/graph/token.js","mtime":1653708835728},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/cache-loader/dist/cjs.js","mtime":1653708689072},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js","mtime":1653708688758},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/eslint-loader/index.js","mtime":1653708690128}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy94dWZlaS9EZXNrdG9wL0Zsb3dNb2RlbC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL1VzZXJzL3h1ZmVpL0Rlc2t0b3AvRmxvd01vZGVsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL1VzZXJzL3h1ZmVpL0Rlc2t0b3AvRmxvd01vZGVsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCB7IFN0YWtlLCBVbnN0YWtlLCBWZXN0IH0gZnJvbSAiLi9hY3Rpb24iOwppbXBvcnQgeyBOb25OZWdhdGl2ZSwgU3RhbmRhcmROdW0gfSBmcm9tICIuLi91dGlscy9udW1iZXJVdGlsIjsKZXhwb3J0IHZhciBUb2tlbiA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgLy8gY29uc3RydWN0b3IKICAvLyBwYXJhbXM6CiAgLy8gICAgICBzeW1ib2w6ICJBcGV4IiwKICAvLyAgICAgIHRvdGFsU3VwcGx5OiAxMDAwMDAwLAogIC8vICAgICAgYWxsb2NhdGlvbnM6IFsKICAvLyAgICAgICAgICB7IG5hbWU6ICJUZWFtIiwgcHJvcDogMCwgY2xhc3M6ICJ0ZWFtLXNsaWRlciIgfSwKICAvLyAgICAgICAgICB7IG5hbWU6ICJJbnZlc3RvciIsIHByb3A6IDAsIGNsYXNzOiAiaW52ZXN0b3Itc2xpZGVyIiB9LAogIC8vICAgICAgICAgIHsgbmFtZTogIkFkdmlzb3IiLCBwcm9wOiAwLCBjbGFzczogImFkdmlzb3Itc2xpZGVyIiB9LAogIC8vICAgICAgICAgIHsgbmFtZTogIkZvdW5kYXRpb24iLCBwcm9wOiAwLCBjbGFzczogImZvdW5kYXRpb24tc2xpZGVyIiB9LAogIC8vICAgICAgICAgIHsgbmFtZTogIkNvbW11bml0eSIsIHByb3A6IDAsIGNsYXNzOiAiY29tbXVuaXR5LXNsaWRlciIgfSwKICAvLyAgICAgIF0sCiAgLy8gICAgICBjb21tdW5pdHk6IHsKICAvLyAgICAgICAgICBhbGxvY2F0aW9uczogWwogIC8vICAgICAgICAgICAgICB7IG5hbWU6ICJBaXJkcm9wIiwgcHJvcDogMCwgY2xhc3M6ICJhaXJkcm9wLXR1cm50YWJsZSIgfSwKICAvLyAgICAgICAgICAgICAgeyBuYW1lOiAiU3Rha2luZyIsIHByb3A6IDAsIGNsYXNzOiAic3Rha2luZy10dXJudGFibGUiIH0sCiAgLy8gICAgICAgICAgXSwKICAvLyAgICAgICAgICBzdGFraW5nTGlmZXRpbWU6IDAsCiAgLy8gICAgICAgICAgc3Rha2luZ1Jld2FyZFJlZnJlc2g6IDAsCiAgLy8gICAgICAgICAgc3Rha2luZ1Jld2FyZERlY3JlYXNlRmFjdG9yOiAwLAogIC8vICAgICAgfSwKICBmdW5jdGlvbiBUb2tlbihzeW1ib2wsIHRvdGFsU3VwcGx5LCBhbGxvY2F0aW9ucywgY29tbXVuaXR5KSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUb2tlbik7CgogICAgdGhpcy5zeW1ib2wgPSBzeW1ib2w7CiAgICB0aGlzLnRvdGFsU3VwcGx5ID0gTnVtYmVyKHRvdGFsU3VwcGx5KTsgLy8gVE9ETyBzdGFrZWRQZXJjZW50IOaYr+WQpuW/heimgT8KICAgIC8vIFRPRE8gZnJlZU1vbmV5UGVyY2VudCDmmK/lkKblv4XopoHvvJ8KICAgIC8vIGFsbG9jYXRlZEFtb3VudDog6aG555uu5Y+R6KGM5Luj5biB5bey6YCa6L+HIFZlc3Qg5YiG6YWN5Ye65Y6755qE5pWw6YePCiAgICAvLyBFeGFtcGxlOiB7IlRlYW0iOiAyMDAsICJDb21tdW5pdHkiOiA4MDB9CgogICAgdGhpcy5hbGxvY2F0ZWRBbW91bnQgPSBuZXcgTWFwKCk7IC8vIGFsbG9jYXRlZEFtb3VudERlbHRhOiDpobnnm67lj5HooYzku6PluIHlt7LpgJrov4cgVmVzdCDliIbphY3lh7rljrvnmoTmlbDph48g5aKe6YeP5pWw5o2uCgogICAgdGhpcy5hbGxvY2F0ZWRBbW91bnREZWx0YSA9IG5ldyBNYXAoKTsgLy8gYWxsb2NhdGVkQW1vdW50VG90YWw6IOmhueebruWPkeihjOS7o+W4geW3sumAmui/hyBWZXN0IOWIhumFjeWHuuWOu+eahOaAu+mHjwoKICAgIHRoaXMuYWxsb2NhdGVkQW1vdW50VG90YWwgPSBOdW1iZXIoMCk7IC8vIGFsbG9jYXRpb25QZXJjZW50OiDpobnnm67ku6PluIHliIbphY3mlrnmoYgKICAgIC8vIEV4YW1wbGU6IHsiVGVhbSI6IDAuMiwgIkNvbW11bml0eSI6IDAuOH0KCiAgICB0aGlzLmFsbG9jYXRpb25QZXJjZW50ID0gbmV3IE1hcCgpOyAvLyBzdGFrZWRBbW91bnQ6IOS7o+W4geWcqOi0qOaKvOaxoOS4rei0qOaKvOeahOaVsOmHjwogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMTAwLCAiQ29tbXVuaXR5IjogMTAwfQoKICAgIHRoaXMuc3Rha2VkQW1vdW50ID0gbmV3IE1hcCgpOyAvLyBzdGFrZWRBbW91bnREZWx0YTog5Luj5biB5Zyo6LSo5oq85rGg5Lit6LSo5oq855qE5pWw6YePIOWinumHj+aVsOaNrgogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMCwgIkNvbW11bml0eSI6IDB9CgogICAgdGhpcy5zdGFrZWRBbW91bnREZWx0YSA9IG5ldyBNYXAoKTsgLy8gc3Rha2VkVG90YWw6IOS7o+W4geWcqOi0qOaKvOaxoOS4reeahOaAu+mHjwoKICAgIHRoaXMuc3Rha2VkVG90YWwgPSBOdW1iZXIoMCk7IC8vIGZyZWVNb25leTog5Luj5biB5Y+v5Lul6Ieq55Sx5rWB6YCa5L2/55So55qE5pWw6YePCiAgICAvLyBFeGFtcGxlOiB7IlRlYW0iOiAxMDAsICJDb21tdW5pdHkiOiA3MDB9CgogICAgdGhpcy5mcmVlTW9uZXkgPSBuZXcgTWFwKCk7IC8vIGZyZWVNb25leURlbHRhOiDku6PluIHlj6/ku6Xoh6rnlLHmtYHpgJrkvb/nlKjnmoTmlbDph48g5aKe6YeP5pWw5o2uCiAgICAvLyBFeGFtcGxlOiB7IlRlYW0iOiAwLCAiQ29tbXVuaXR5IjogMH0KCiAgICB0aGlzLmZyZWVNb25leURlbHRhID0gbmV3IE1hcCgpOyAvLyBmcmVlTW9uZXlUb3RhbDog5Luj5biB5Y+v5Lul6Ieq55Sx5rWB6YCa55qE5oC76YePCgogICAgdGhpcy5mcmVlTW9uZXlUb3RhbCA9IE51bWJlcigwKTsKICAgIGFsbG9jYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgLy8g6I635Y+WIGFsbG9jYXRpb25QZXJjZW50IOaVsOaNrgogICAgICBfdGhpcy5hbGxvY2F0aW9uUGVyY2VudC5zZXQoZWxlbWVudC5uYW1lLCBOdW1iZXIoZWxlbWVudC5wcm9wKSAvIDEwMCk7CgogICAgICBfdGhpcy5hbGxvY2F0ZWRBbW91bnQuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKDApKTsKCiAgICAgIF90aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldChlbGVtZW50Lm5hbWUsIE51bWJlcigwKSk7CgogICAgICBfdGhpcy5zdGFrZWRBbW91bnQuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKDApKTsKCiAgICAgIF90aGlzLnN0YWtlZEFtb3VudERlbHRhLnNldChlbGVtZW50Lm5hbWUsIE51bWJlcigwKSk7CgogICAgICBfdGhpcy5mcmVlTW9uZXkuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKDApKTsKCiAgICAgIF90aGlzLmZyZWVNb25leURlbHRhLnNldChlbGVtZW50Lm5hbWUsIE51bWJlcigwKSk7CiAgICB9KTsgLy8gVE9ETyDov5jpnIDopoHogIPomZEgcHVibGljIHNhbGUg6YOo5YiGCiAgICAvLyBjb21tdW5pdHlQb2xpY3k6IHRva2VuIOe7meekvuWMuuWIhumFjeS7o+W4geeahOetlueVpQoKICAgIHRoaXMuY29tbXVuaXR5UG9saWN5ID0gewogICAgICBhbGxvY2F0aW9uczogbmV3IE1hcCgpLAogICAgICAvLyDnpL7ljLrku6PluIHnmoTliIbphY3mr5TkvosgRXhhbXBsZTogeyJBaXJkcm9wIjogMC4yLCAiU3Rha2luZyI6IDAuOH0KICAgICAgc3Rha2luZ1Bvb2w6IE51bWJlcigwKSwKICAgICAgLy8gVE9ETyBbRE9ORSwg6L+Y5Y+v5Lul5aaC5L2V5LyY5YyW77yfXSDlpoLkvZXmm7TmlrDov5nkuKogc3Rha2luZ1Bvb2w/IOWcqOWunuS+i+WMliBTdGFrZSDoioLngrnml7bvvIzmoLnmja7lhbYgcmV3YXJkUG9saWN5RnJvbSDlj4LmlbDmnaXmm7TmlLnlr7nlupQgdG9rZW4g55qEIHN0YWtpbmdQb29sIOWxnuaApyAKICAgICAgc3Rha2luZ1Jld2FyZExpZmV0aW1lOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdMaWZldGltZSksCiAgICAgIHN0YWtpbmdSZXdhcmRSZWZyZXNoUGVyaW9kOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdSZXdhcmRSZWZyZXNoKSwKICAgICAgc3Rha2luZ1Jld2FyZERlZmFjdG9yOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdSZXdhcmREZWNyZWFzZUZhY3RvcikgLyAxMDAKICAgIH07CiAgICBjb21tdW5pdHkuYWxsb2NhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICBfdGhpcy5jb21tdW5pdHlQb2xpY3kuYWxsb2NhdGlvbnMuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKGVsZW1lbnQucHJvcCkgLyAxMDApOwogICAgfSk7IC8vIGNhblZlc3Q6IHRva2VuIOaYr+WQpuWPr+S7pSB2ZXN0IAoKICAgIHRoaXMuY2FuVmVzdCA9IE51bWJlcigxKTsgLy8g56S+5Yy655qE5Y+R6KGM562W55Wl5Lit5Y+v6IO95pyJ55u05o6l5a+55aSW5Y+R5ZSuL+epuuaKleeahOW4gSwg6L+Z6YOo5YiG5biB5Zyo5LiA5byA5aeL5bCx5bGe5LqOIGZyZWVNb25leQoKICAgIGlmICh0aGlzLmNvbW11bml0eVBvbGljeS5hbGxvY2F0aW9ucy5oYXMoIkFpcmRyb3AiKSkgewogICAgICB2YXIgYW1vdW50ID0gU3RhbmRhcmROdW0odGhpcy50b3RhbFN1cHBseSAqIHRoaXMuYWxsb2NhdGlvblBlcmNlbnQuZ2V0KCJDb21tdW5pdHkiKSAqIHRoaXMuY29tbXVuaXR5UG9saWN5LmFsbG9jYXRpb25zLmdldCgiQWlyZHJvcCIpKTsKICAgICAgdGhpcy5mcmVlTW9uZXkuc2V0KCJDb21tdW5pdHkiLCBTdGFuZGFyZE51bSh0aGlzLmZyZWVNb25leS5nZXQoIkNvbW11bml0eSIpICsgYW1vdW50KSk7CiAgICAgIHRoaXMuZnJlZU1vbmV5VG90YWwgKz0gYW1vdW50OwogICAgfQoKICAgIGlmICh0aGlzLmNvbW11bml0eVBvbGljeS5hbGxvY2F0aW9ucy5oYXMoIlB1YmxpY1NhbGUiKSkgewogICAgICB2YXIgX2Ftb3VudCA9IFN0YW5kYXJkTnVtKHRoaXMudG90YWxTdXBwbHkgKiB0aGlzLmFsbG9jYXRpb25QZXJjZW50LmdldCgiQ29tbXVuaXR5IikgKiB0aGlzLmNvbW11bml0eVBvbGljeS5hbGxvY2F0aW9ucy5nZXQoIlB1YmxpY1NhbGUiKSk7CgogICAgICB0aGlzLmZyZWVNb25leS5zZXQoIkNvbW11bml0eSIsIFN0YW5kYXJkTnVtKHRoaXMuZnJlZU1vbmV5LmdldCgiQ29tbXVuaXR5IikgKyBfYW1vdW50KSk7CiAgICAgIHRoaXMuZnJlZU1vbmV5VG90YWwgKz0gX2Ftb3VudDsKICAgIH0KCiAgICB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldCgiQ29tbXVuaXR5IiwgU3RhbmRhcmROdW0odGhpcy5hbGxvY2F0aW9uUGVyY2VudC5nZXQoIkNvbW11bml0eSIpICogdGhpcy50b3RhbFN1cHBseSkpOwogIH0gLy8g5omn6KGM5rWL566X6YC76L6RCgoKICBfY3JlYXRlQ2xhc3MoVG9rZW4sIFt7CiAgICBrZXk6ICJydW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJ1bihwcmVOb2RlLCBjdXJEYXkpIHsKICAgICAgLy8g5aaC5p6c5rKh5pyJ5YmN5bqP6IqC54K577yM5YiZ5LiN5Lya5omn6KGM5rWL566X6YC76L6RCiAgICAgIGlmIChwcmVOb2RlID09IG51bGwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChwcmVOb2RlLmNvbnN0cnVjdG9yID09PSBUb2tlbikgewogICAgICAgIC8vIFRPRE8gVG9rZW4g6IqC54K555qE5YmN5bqP6IqC54K55pivIFRva2VuIOeahOaDheWGteaaguaXtuS4jeWkhOeQhgogICAgICAgIHJldHVybjsKICAgICAgfSBlbHNlIGlmIChwcmVOb2RlLmNvbnN0cnVjdG9yID09PSBTdGFrZSkgewogICAgICAgIC8vIOaKiuWJjeW6jyBTdGFrZSDoioLngrnliIbphY3nmoQgcmV3YXJkIOWKoOWIsOiHqui6q+eahCBmcmVlTW9uZXlEZWx0YSDlop7ph4/mlbDmja7kuIoKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5mcmVlTW9uZXlEZWx0YSksCiAgICAgICAgICAgIF9zdGVwOwoKICAgICAgICB0cnkgewogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTsKCiAgICAgICAgICAgIGlmIChwcmVOb2RlLnJld2FyZEFsbG9jYXRlZERlbHRhLmhhcyhpdGVtWzBdKSkgewogICAgICAgICAgICAgIGl0ZW1bMV0gKz0gcHJlTm9kZS5yZXdhcmRBbGxvY2F0ZWREZWx0YS5nZXQoaXRlbVswXSk7CiAgICAgICAgICAgICAgdGhpcy5mcmVlTW9uZXlEZWx0YS5zZXQoaXRlbVswXSwgU3RhbmRhcmROdW0oaXRlbVsxXSkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcmVOb2RlLmNvbnN0cnVjdG9yID09PSBVbnN0YWtlKSB7CiAgICAgICAgLy8g5aaC5p6c5YmN5bqPIHVuc3Rha2Ug6IqC54K555qEIHVuc3Rha2VIaXN0b3J5IOS4reacieW9k+WkqeeahOmHiuaUvuiusOW9le+8jOWImeaKiumHiuaUvueahOW4geWKoOWIsOiHqui6q+eahCBmcmVlTW9uZXlEZWx0YSDkuIoKICAgICAgICBpZiAocHJlTm9kZS51bnN0YWtlSGlzdG9yeS5oYXMoY3VyRGF5KSkgewogICAgICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leURlbHRhKSwKICAgICAgICAgICAgICBfc3RlcDI7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgX2l0ZW0gPSBfc3RlcDIudmFsdWU7CgogICAgICAgICAgICAgIGlmIChwcmVOb2RlLnVuc3Rha2VIaXN0b3J5LmdldChjdXJEYXkpLmhhcyhfaXRlbVswXSkpIHsKICAgICAgICAgICAgICAgIF9pdGVtWzFdICs9IHByZU5vZGUudW5zdGFrZUhpc3RvcnkuZ2V0KGN1ckRheSkuZ2V0KF9pdGVtWzBdKTsKICAgICAgICAgICAgICAgIHRoaXMuZnJlZU1vbmV5RGVsdGEuc2V0KF9pdGVtWzBdLCBTdGFuZGFyZE51bShfaXRlbVsxXSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBUT0RPIHZlc3RIaXN0b3J5IOaaguaXtuS4jeiDveWIoOmZpO+8jOWQpuWImeaXoOazleWcqOaVsOaNruWPr+inhuWMlumdouadv+eci+WIsOacieaViOaVsOaNrgogICAgICAgICAgICAvLyBwcmVOb2RlLnVuc3Rha2VIaXN0b3J5LmRlbGV0ZShjdXJEYXkpOwoKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcmVOb2RlLmNvbnN0cnVjdG9yID09PSBWZXN0KSB7CiAgICAgICAgLy8g5aaC5p6c5YmN5bqPIHZlc3Qg6IqC54K555qEIHZlc3RIaXN0b3J5IOS4reacieW9k+WkqeeahOmHiuaUvuiusOW9le+8jOWImeaKiumHiuaUvueahOW4geWKoOWIsOiHqui6q+eahCBmcmVlTW9uZXlEZWx0YSDkuIoKICAgICAgICBpZiAocHJlTm9kZS52ZXN0SGlzdG9yeS5oYXMoY3VyRGF5KSkgewogICAgICAgICAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leURlbHRhKSwKICAgICAgICAgICAgICBfc3RlcDM7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IzLnMoKTsgIShfc3RlcDMgPSBfaXRlcmF0b3IzLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgX2l0ZW0yID0gX3N0ZXAzLnZhbHVlOwoKICAgICAgICAgICAgICBpZiAocHJlTm9kZS52ZXN0SGlzdG9yeS5nZXQoY3VyRGF5KS5oYXMoX2l0ZW0yWzBdKSkgewogICAgICAgICAgICAgICAgX2l0ZW0yWzFdICs9IHByZU5vZGUudmVzdEhpc3RvcnkuZ2V0KGN1ckRheSkuZ2V0KF9pdGVtMlswXSk7CiAgICAgICAgICAgICAgICB0aGlzLmZyZWVNb25leURlbHRhLnNldChfaXRlbTJbMF0sIFN0YW5kYXJkTnVtKF9pdGVtMlsxXSkpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSAvLyBUT0RPIHZlc3RIaXN0b3J5IOaaguaXtuS4jeiDveWIoOmZpO+8jOWQpuWImeaXoOazleWcqOaVsOaNruWPr+inhuWMlumdouadv+eci+WIsOacieaViOaVsOaNrgogICAgICAgICAgICAvLyBwcmVOb2RlLnZlc3RIaXN0b3J5LmRlbGV0ZShjdXJEYXkpOwoKICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IzLmUoZXJyKTsKICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjMuZigpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsvLyBsb2cg5o+Q56S65oql6ZSZOiDkuI3mlK/mjIHnmoToioLngrnnsbvlnosKICAgICAgICB9CiAgICB9IC8vIOaJp+ihjCBEZWx0YSDmlbDmja7liLAgQ29tbWl0IOaVsOaNrueahOabtOaWsAoKICB9LCB7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZSgpIHsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBmcmVlTW9uZXlEZWx0YToiLCB0aGlzLmZyZWVNb25leURlbHRhKTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBzdGFrZWRBbW91bnREZWx0YToiLCB0aGlzLnN0YWtlZEFtb3VudERlbHRhKTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBhbGxvY2F0ZWRBbW91bnREZWx0YToiLCB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhKTsgLy8g5omn6KGMIHN0YWtlZEFtb3VudCDnmoTmlbDmja7mm7TmlrAsIOW5tumHjee9ruWinumHj+aVsOaNrgoKICAgICAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLnN0YWtlZEFtb3VudC5lbnRyaWVzKCkpLAogICAgICAgICAgX3N0ZXA0OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcDQudmFsdWU7CiAgICAgICAgICBpdGVtWzFdID0gTm9uTmVnYXRpdmUoaXRlbVsxXSArIHRoaXMuc3Rha2VkQW1vdW50RGVsdGEuZ2V0KGl0ZW1bMF0pKTsKICAgICAgICAgIHRoaXMuc3Rha2VkQW1vdW50LnNldChpdGVtWzBdLCBTdGFuZGFyZE51bShpdGVtWzFdKSk7CiAgICAgICAgICB0aGlzLnN0YWtlZFRvdGFsID0gTm9uTmVnYXRpdmUodGhpcy5zdGFrZWRUb3RhbCArIHRoaXMuc3Rha2VkQW1vdW50RGVsdGEuZ2V0KGl0ZW1bMF0pKTsKICAgICAgICAgIHRoaXMuc3Rha2VkQW1vdW50RGVsdGEuc2V0KGl0ZW1bMF0sIE51bWJlcigwKSk7CiAgICAgICAgfSAvLyDmiafooYwgZnJlZU1vbmV5IOeahOaVsOaNruabtOaWsCwg5bm26YeN572u5aKe6YeP5pWw5o2uCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leS5lbnRyaWVzKCkpLAogICAgICAgICAgX3N0ZXA1OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9pdGVtMyA9IF9zdGVwNS52YWx1ZTsKICAgICAgICAgIF9pdGVtM1sxXSA9IE5vbk5lZ2F0aXZlKF9pdGVtM1sxXSArIHRoaXMuZnJlZU1vbmV5RGVsdGEuZ2V0KF9pdGVtM1swXSkpOwogICAgICAgICAgdGhpcy5mcmVlTW9uZXkuc2V0KF9pdGVtM1swXSwgU3RhbmRhcmROdW0oX2l0ZW0zWzFdKSk7CiAgICAgICAgICB0aGlzLmZyZWVNb25leVRvdGFsID0gTm9uTmVnYXRpdmUodGhpcy5mcmVlTW9uZXlUb3RhbCArIHRoaXMuZnJlZU1vbmV5RGVsdGEuZ2V0KF9pdGVtM1swXSkpOwogICAgICAgICAgdGhpcy5mcmVlTW9uZXlEZWx0YS5zZXQoX2l0ZW0zWzBdLCBOdW1iZXIoMCkpOwogICAgICAgIH0gLy8g5omn6KGMIGFsbG9jYXRlZEFtb3VudCDnmoTmlbDmja7mm7TmlrDvvIzlubbph43nva7lop7ph4/mlbDmja4KCiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjUuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjUuZigpOwogICAgICB9CgogICAgICB2YXIgX2l0ZXJhdG9yNiA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuYWxsb2NhdGVkQW1vdW50LmVudHJpZXMoKSksCiAgICAgICAgICBfc3RlcDY7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNi5zKCk7ICEoX3N0ZXA2ID0gX2l0ZXJhdG9yNi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgX2l0ZW00ID0gX3N0ZXA2LnZhbHVlOwogICAgICAgICAgX2l0ZW00WzFdID0gTm9uTmVnYXRpdmUoX2l0ZW00WzFdICsgdGhpcy5hbGxvY2F0ZWRBbW91bnREZWx0YS5nZXQoX2l0ZW00WzBdKSk7CiAgICAgICAgICB0aGlzLmFsbG9jYXRlZEFtb3VudC5zZXQoX2l0ZW00WzBdLCBTdGFuZGFyZE51bShfaXRlbTRbMV0pKTsKICAgICAgICAgIHRoaXMuYWxsb2NhdGVkQW1vdW50VG90YWwgPSBOb25OZWdhdGl2ZSh0aGlzLmFsbG9jYXRlZEFtb3VudFRvdGFsICsgdGhpcy5hbGxvY2F0ZWRBbW91bnREZWx0YS5nZXQoX2l0ZW00WzBdKSk7CiAgICAgICAgICB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldChfaXRlbTRbMF0sIE51bWJlcigwKSk7CiAgICAgICAgfSAvLyDlr7nkuo7mnInlj5HooYzph4/nmoTluIHvvIzpnIDopoHmm7TmlrAgY2FuVmVzdCDlj4LmlbAKCiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIF9pdGVyYXRvcjYuZShlcnIpOwogICAgICB9IGZpbmFsbHkgewogICAgICAgIF9pdGVyYXRvcjYuZigpOwogICAgICB9CgogICAgICBpZiAodGhpcy50b3RhbFN1cHBseSA+IDApIHsKICAgICAgICBpZiAodGhpcy5hbGxvY2F0ZWRBbW91bnRUb3RhbCA8IHRoaXMudG90YWxTdXBwbHkpIHsKICAgICAgICAgIC8vIOW9k+W3sumAmui/hyBWZXN0IOWIhumFjeWHuuWOu+eahOmHj+Wwj+S6juWPkeihjOaAu+mHj+aXtu+8jOWFgeiuuOe7p+e7rSB2ZXN0CiAgICAgICAgICB0aGlzLmNhblZlc3QgPSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlvZPlt7LpgJrov4cgVmVzdCDliIbphY3lh7rljrvnmoTph4/lpKfkuo7nrYnkuo7lj5HooYzmgLvph4/ml7bvvIzkuI3lhYHorrjnu6fnu60gdmVzdAogICAgICAgICAgdGhpcy5jYW5WZXN0ID0gMDsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3ltYm9sLCAiOjp0b2tlbjogc3Rha2VkQW1vdW50OiIsIHRoaXMuc3Rha2VkQW1vdW50KTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBzdGFrZWRUb3RhbDoiLCB0aGlzLnN0YWtlZFRvdGFsKTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBmcmVlTW9uZXk6IiwgdGhpcy5mcmVlTW9uZXkpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IGZyZWVNb25leVRvdGFsOiIsIHRoaXMuZnJlZU1vbmV5VG90YWwpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IGFsbG9jYXRlZEFtb3VudDoiLCB0aGlzLmFsbG9jYXRlZEFtb3VudCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3ltYm9sLCAiOjp0b2tlbjogYWxsb2NhdGVkQW1vdW50VG90YWw6IiwgdGhpcy5hbGxvY2F0ZWRBbW91bnRUb3RhbCk7CiAgICB9IC8vICDmm7TmlrDlt7LlrZjlnKjnmoQgVG9rZW4g5a6e5L6L6YeM55qE5Y+C5pWwCgogIH0sIHsKICAgIGtleTogInNlbGZVcGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGZVcGRhdGUoc3ltYm9sLCB0b3RhbFN1cHBseSwgYWxsb2NhdGlvbnMsIGNvbW11bml0eSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuc3ltYm9sID0gc3ltYm9sOwogICAgICB0aGlzLnRvdGFsU3VwcGx5ID0gTnVtYmVyKHRvdGFsU3VwcGx5KTsKICAgICAgYWxsb2NhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIC8vIOabtOaWsCBhbGxvY2F0aW9uUGVyY2VudCDmlbDmja4KICAgICAgICBfdGhpczIuYWxsb2NhdGlvblBlcmNlbnQuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKGVsZW1lbnQucHJvcCkgLyAxMDApOwogICAgICB9KTsKICAgICAgdGhpcy5jb21tdW5pdHlQb2xpY3kuc3Rha2luZ1Jld2FyZExpZmV0aW1lID0gTnVtYmVyKGNvbW11bml0eS5zdGFraW5nTGlmZXRpbWUpOwogICAgICB0aGlzLmNvbW11bml0eVBvbGljeS5zdGFraW5nUmV3YXJkUmVmcmVzaFBlcmlvZCA9IE51bWJlcihjb21tdW5pdHkuc3Rha2luZ1Jld2FyZFJlZnJlc2gpOwogICAgICB0aGlzLmNvbW11bml0eVBvbGljeS5zdGFraW5nUmV3YXJkRGVmYWN0b3IgPSBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdSZXdhcmREZWNyZWFzZUZhY3RvcikgLyAxMDA7CiAgICAgIGNvbW11bml0eS5hbGxvY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgX3RoaXMyLmNvbW11bml0eVBvbGljeS5hbGxvY2F0aW9ucy5zZXQoZWxlbWVudC5uYW1lLCBOdW1iZXIoZWxlbWVudC5wcm9wKSAvIDEwMCk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFRva2VuOwp9KCk7"},{"version":3,"sources":["/Users/xufei/Desktop/FlowModel/src/graph/token.js"],"names":["Stake","Unstake","Vest","NonNegative","StandardNum","Token","symbol","totalSupply","allocations","community","Number","allocatedAmount","Map","allocatedAmountDelta","allocatedAmountTotal","allocationPercent","stakedAmount","stakedAmountDelta","stakedTotal","freeMoney","freeMoneyDelta","freeMoneyTotal","forEach","element","set","name","prop","communityPolicy","stakingPool","stakingRewardLifetime","stakingLifetime","stakingRewardRefreshPeriod","stakingRewardRefresh","stakingRewardDefactor","stakingRewardDecreaseFactor","canVest","has","amount","get","preNode","curDay","constructor","item","rewardAllocatedDelta","unstakeHistory","vestHistory","console","log","entries"],"mappings":"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","sourcesContent":["import { Stake, Unstake, Vest } from \"./action\";\nimport { NonNegative, StandardNum } from \"../utils/numberUtil\";\nexport class Token {\n\n    // constructor\n    // params:\n    //      symbol: \"Apex\",\n    //      totalSupply: 1000000,\n    //      allocations: [\n    //          { name: \"Team\", prop: 0, class: \"team-slider\" },\n    //          { name: \"Investor\", prop: 0, class: \"investor-slider\" },\n    //          { name: \"Advisor\", prop: 0, class: \"advisor-slider\" },\n    //          { name: \"Foundation\", prop: 0, class: \"foundation-slider\" },\n    //          { name: \"Community\", prop: 0, class: \"community-slider\" },\n    //      ],\n    //      community: {\n    //          allocations: [\n    //              { name: \"Airdrop\", prop: 0, class: \"airdrop-turntable\" },\n    //              { name: \"Staking\", prop: 0, class: \"staking-turntable\" },\n    //          ],\n    //          stakingLifetime: 0,\n    //          stakingRewardRefresh: 0,\n    //          stakingRewardDecreaseFactor: 0,\n    //      },\n    constructor(symbol, totalSupply, allocations, community) {\n        this.symbol = symbol;\n        this.totalSupply = Number(totalSupply);\n\n        // TODO stakedPercent 是否必要?\n        // TODO freeMoneyPercent 是否必要？\n\n        // allocatedAmount: 项目发行代币已通过 Vest 分配出去的数量\n        // Example: {\"Team\": 200, \"Community\": 800}\n        this.allocatedAmount = new Map();\n        // allocatedAmountDelta: 项目发行代币已通过 Vest 分配出去的数量 增量数据\n        this.allocatedAmountDelta = new Map();\n        // allocatedAmountTotal: 项目发行代币已通过 Vest 分配出去的总量\n        this.allocatedAmountTotal = Number(0);\n        // allocationPercent: 项目代币分配方案\n        // Example: {\"Team\": 0.2, \"Community\": 0.8}\n        this.allocationPercent = new Map();\n        // stakedAmount: 代币在质押池中质押的数量\n        // Example: {\"Team\": 100, \"Community\": 100}\n        this.stakedAmount = new Map();\n        // stakedAmountDelta: 代币在质押池中质押的数量 增量数据\n        // Example: {\"Team\": 0, \"Community\": 0}\n        this.stakedAmountDelta = new Map();\n        // stakedTotal: 代币在质押池中的总量\n        this.stakedTotal = Number(0);\n        // freeMoney: 代币可以自由流通使用的数量\n        // Example: {\"Team\": 100, \"Community\": 700}\n        this.freeMoney = new Map();\n        // freeMoneyDelta: 代币可以自由流通使用的数量 增量数据\n        // Example: {\"Team\": 0, \"Community\": 0}\n        this.freeMoneyDelta = new Map();\n        // freeMoneyTotal: 代币可以自由流通的总量\n        this.freeMoneyTotal = Number(0);\n\n        allocations.forEach(element => {\n            // 获取 allocationPercent 数据\n            this.allocationPercent.set(element.name, Number(element.prop) / 100);    \n\n            this.allocatedAmount.set(element.name, Number(0));\n            this.allocatedAmountDelta.set(element.name, Number(0));\n            this.stakedAmount.set(element.name, Number(0));\n            this.stakedAmountDelta.set(element.name, Number(0));\n            this.freeMoney.set(element.name, Number(0));\n            this.freeMoneyDelta.set(element.name, Number(0));\n        })\n\n        // TODO 还需要考虑 public sale 部分\n        // communityPolicy: token 给社区分配代币的策略\n        this.communityPolicy = {\n            allocations: new Map(), // 社区代币的分配比例 Example: {\"Airdrop\": 0.2, \"Staking\": 0.8}\n            stakingPool:                Number(0), // TODO [DONE, 还可以如何优化？] 如何更新这个 stakingPool? 在实例化 Stake 节点时，根据其 rewardPolicyFrom 参数来更改对应 token 的 stakingPool 属性 \n            stakingRewardLifetime:      Number(community.stakingLifetime),\n            stakingRewardRefreshPeriod: Number(community.stakingRewardRefresh),\n            stakingRewardDefactor:      Number(community.stakingRewardDecreaseFactor) / 100,\n        }\n\n        community.allocations.forEach(element => {\n            this.communityPolicy.allocations.set(element.name, Number(element.prop) / 100);\n        })\n\n        // canVest: token 是否可以 vest \n        this.canVest = Number(1);\n\n        // 社区的发行策略中可能有直接对外发售/空投的币, 这部分币在一开始就属于 freeMoney\n        if (this.communityPolicy.allocations.has(\"Airdrop\") ) {\n            let amount =  StandardNum(this.totalSupply * this.allocationPercent.get(\"Community\") * this.communityPolicy.allocations.get(\"Airdrop\"));\n            this.freeMoney.set(\"Community\", StandardNum(this.freeMoney.get(\"Community\") + amount));\n            this.freeMoneyTotal += amount;\n        }\n        if (this.communityPolicy.allocations.has(\"PublicSale\")) {\n            let amount = StandardNum(this.totalSupply * this.allocationPercent.get(\"Community\") * this.communityPolicy.allocations.get(\"PublicSale\"));\n            this.freeMoney.set(\"Community\", StandardNum(this.freeMoney.get(\"Community\") + amount));\n            this.freeMoneyTotal += amount;\n        }\n        this.allocatedAmountDelta.set(\"Community\", StandardNum(this.allocationPercent.get(\"Community\") * this.totalSupply));\n    }\n\n    // 执行测算逻辑\n    run(preNode, curDay) {\n\n        // 如果没有前序节点，则不会执行测算逻辑\n        if (preNode == null) {\n            return ;\n        }\n\n        if (preNode.constructor === Token) {\n            // TODO Token 节点的前序节点是 Token 的情况暂时不处理\n            return ;\n        } \n        else if (preNode.constructor === Stake) {\n            // 把前序 Stake 节点分配的 reward 加到自身的 freeMoneyDelta 增量数据上\n            for (let item of this.freeMoneyDelta) {\n                if (preNode.rewardAllocatedDelta.has(item[0])) {\n                    item[1] += preNode.rewardAllocatedDelta.get(item[0]);\n                    this.freeMoneyDelta.set(item[0], StandardNum(item[1]));\n                }\n            }\n            \n        } \n        else if (preNode.constructor === Unstake) {\n            // 如果前序 unstake 节点的 unstakeHistory 中有当天的释放记录，则把释放的币加到自身的 freeMoneyDelta 上\n            if (preNode.unstakeHistory.has(curDay)) {\n                for (let item of this.freeMoneyDelta) {\n                    if (preNode.unstakeHistory.get(curDay).has(item[0])) {\n                        item[1] += preNode.unstakeHistory.get(curDay).get(item[0]);\n                        this.freeMoneyDelta.set(item[0], StandardNum(item[1]));\n                    }\n                    \n                }\n\n                // TODO vestHistory 暂时不能删除，否则无法在数据可视化面板看到有效数据\n                // preNode.unstakeHistory.delete(curDay);\n            }\n        } \n        else if (preNode.constructor === Vest) {\n            // 如果前序 vest 节点的 vestHistory 中有当天的释放记录，则把释放的币加到自身的 freeMoneyDelta 上\n            if (preNode.vestHistory.has(curDay)) {\n                for (let item of this.freeMoneyDelta) {\n                    if (preNode.vestHistory.get(curDay).has(item[0])) {\n                        item[1] += preNode.vestHistory.get(curDay).get(item[0]);\n                        this.freeMoneyDelta.set(item[0], StandardNum(item[1]));\n                    }\n                    \n                }\n\n                // TODO vestHistory 暂时不能删除，否则无法在数据可视化面板看到有效数据\n                // preNode.vestHistory.delete(curDay);\n            }\n        }\n        else {\n            // log 提示报错: 不支持的节点类型\n        }\n\n    }\n\n    // 执行 Delta 数据到 Commit 数据的更新\n    update() {\n        console.log(this.symbol, \"::token: freeMoneyDelta:\", this.freeMoneyDelta);\n        console.log(this.symbol, \"::token: stakedAmountDelta:\", this.stakedAmountDelta);\n        console.log(this.symbol, \"::token: allocatedAmountDelta:\", this.allocatedAmountDelta);\n        // 执行 stakedAmount 的数据更新, 并重置增量数据\n        for(let item of this.stakedAmount.entries()) {\n            item[1] = NonNegative(item[1] + this.stakedAmountDelta.get(item[0]));\n            this.stakedAmount.set(item[0], StandardNum(item[1]));\n            this.stakedTotal = NonNegative(this.stakedTotal + this.stakedAmountDelta.get(item[0]));\n            this.stakedAmountDelta.set(item[0], Number(0));\n        }\n\n        // 执行 freeMoney 的数据更新, 并重置增量数据\n        for(let item of this.freeMoney.entries()) {\n            item[1] = NonNegative(item[1] + this.freeMoneyDelta.get(item[0]));\n            this.freeMoney.set(item[0], StandardNum(item[1]));\n            this.freeMoneyTotal = NonNegative(this.freeMoneyTotal + this.freeMoneyDelta.get(item[0]));\n            this.freeMoneyDelta.set(item[0], Number(0));\n        }\n\n        // 执行 allocatedAmount 的数据更新，并重置增量数据\n        for(let item of this.allocatedAmount.entries()) {\n            item[1] = NonNegative(item[1] + this.allocatedAmountDelta.get(item[0]));\n            this.allocatedAmount.set(item[0], StandardNum(item[1]));\n            this.allocatedAmountTotal = NonNegative(this.allocatedAmountTotal + this.allocatedAmountDelta.get(item[0]));\n            this.allocatedAmountDelta.set(item[0], Number(0));\n        }\n       \n        // 对于有发行量的币，需要更新 canVest 参数\n        if (this.totalSupply > 0) {\n            if (this.allocatedAmountTotal < this.totalSupply) {\n                // 当已通过 Vest 分配出去的量小于发行总量时，允许继续 vest\n                this.canVest = 1;\n            } else {\n                // 当已通过 Vest 分配出去的量大于等于发行总量时，不允许继续 vest\n                this.canVest = 0;\n            }\n        }\n\n        console.log(this.symbol, \"::token: stakedAmount:\", this.stakedAmount);\n        \n        console.log(this.symbol, \"::token: stakedTotal:\", this.stakedTotal);\n        console.log(this.symbol, \"::token: freeMoney:\", this.freeMoney);\n    \n        console.log(this.symbol, \"::token: freeMoneyTotal:\", this.freeMoneyTotal);\n        console.log(this.symbol, \"::token: allocatedAmount:\", this.allocatedAmount);\n        \n        console.log(this.symbol, \"::token: allocatedAmountTotal:\", this.allocatedAmountTotal);\n    }\n\n    //  更新已存在的 Token 实例里的参数\n    selfUpdate(symbol, totalSupply, allocations, community) {\n        this.symbol = symbol;\n        this.totalSupply = Number(totalSupply);\n\n        allocations.forEach(element => {\n            // 更新 allocationPercent 数据\n            this.allocationPercent.set(element.name, Number(element.prop) / 100);    \n        })\n\n        this.communityPolicy.stakingRewardLifetime = Number(community.stakingLifetime);\n        this.communityPolicy.stakingRewardRefreshPeriod = Number(community.stakingRewardRefresh);\n        this.communityPolicy.stakingRewardDefactor = Number(community.stakingRewardDecreaseFactor) / 100;\n\n        community.allocations.forEach(element => {\n            this.communityPolicy.allocations.set(element.name, Number(element.prop) / 100);\n        })\n    }\n}\n"]}]}