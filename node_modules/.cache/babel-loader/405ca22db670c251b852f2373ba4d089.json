{"remainingRequest":"/Users/wangxufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js!/Users/wangxufei/Desktop/FlowModel/node_modules/eslint-loader/index.js??ref--13-0!/Users/wangxufei/Desktop/FlowModel/src/graph/token.js","dependencies":[{"path":"/Users/wangxufei/Desktop/FlowModel/src/graph/token.js","mtime":1652163070426},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangxufei/Desktop/FlowModel/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9Vc2Vycy93YW5neHVmZWkvRGVza3RvcC9GbG93TW9kZWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIi9Vc2Vycy93YW5neHVmZWkvRGVza3RvcC9GbG93TW9kZWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMvd2FuZ3h1ZmVpL0Rlc2t0b3AvRmxvd01vZGVsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCB7IFN0YWtlLCBVbnN0YWtlLCBWZXN0IH0gZnJvbSAiLi9hY3Rpb24iOwpleHBvcnQgdmFyIFRva2VuID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAvLyBjb25zdHJ1Y3RvcgogIC8vIHBhcmFtczoKICAvLyAgICAgIHN5bWJvbDogIkFwZXgiLAogIC8vICAgICAgdG90YWxTdXBwbHk6IDEwMDAwMDAsCiAgLy8gICAgICBhbGxvY2F0aW9uczogWwogIC8vICAgICAgICAgIHsgbmFtZTogIlRlYW0iLCBwcm9wOiAwLCBjbGFzczogInRlYW0tc2xpZGVyIiB9LAogIC8vICAgICAgICAgIHsgbmFtZTogIkludmVzdG9yIiwgcHJvcDogMCwgY2xhc3M6ICJpbnZlc3Rvci1zbGlkZXIiIH0sCiAgLy8gICAgICAgICAgeyBuYW1lOiAiQWR2aXNvciIsIHByb3A6IDAsIGNsYXNzOiAiYWR2aXNvci1zbGlkZXIiIH0sCiAgLy8gICAgICAgICAgeyBuYW1lOiAiRm91bmRhdGlvbiIsIHByb3A6IDAsIGNsYXNzOiAiZm91bmRhdGlvbi1zbGlkZXIiIH0sCiAgLy8gICAgICAgICAgeyBuYW1lOiAiQ29tbXVuaXR5IiwgcHJvcDogMCwgY2xhc3M6ICJjb21tdW5pdHktc2xpZGVyIiB9LAogIC8vICAgICAgXSwKICAvLyAgICAgIGNvbW11bml0eTogewogIC8vICAgICAgICAgIGFsbG9jYXRpb25zOiBbCiAgLy8gICAgICAgICAgICAgIHsgbmFtZTogIkFpcmRyb3AiLCBwcm9wOiAwLCBjbGFzczogImFpcmRyb3AtdHVybnRhYmxlIiB9LAogIC8vICAgICAgICAgICAgICB7IG5hbWU6ICJTdGFraW5nIiwgcHJvcDogMCwgY2xhc3M6ICJzdGFraW5nLXR1cm50YWJsZSIgfSwKICAvLyAgICAgICAgICBdLAogIC8vICAgICAgICAgIHN0YWtpbmdMaWZldGltZTogMCwKICAvLyAgICAgICAgICBzdGFraW5nUmV3YXJkUmVmcmVzaDogMCwKICAvLyAgICAgICAgICBzdGFraW5nUmV3YXJkRGVjcmVhc2VGYWN0b3I6IDAsCiAgLy8gICAgICB9LAogIGZ1bmN0aW9uIFRva2VuKHN5bWJvbCwgdG90YWxTdXBwbHksIGFsbG9jYXRpb25zLCBjb21tdW5pdHkpIHsKICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRva2VuKTsKCiAgICB0aGlzLnN5bWJvbCA9IHN5bWJvbDsKICAgIHRoaXMudG90YWxTdXBwbHkgPSBOdW1iZXIodG90YWxTdXBwbHkpOyAvLyBUT0RPIHN0YWtlZFBlcmNlbnQg5piv5ZCm5b+F6KaBPwogICAgLy8gVE9ETyBmcmVlTW9uZXlQZXJjZW50IOaYr+WQpuW/heimge+8nwogICAgLy8gYWxsb2NhdGVkQW1vdW50OiDpobnnm67lj5HooYzku6PluIHlt7LpgJrov4cgVmVzdCDliIbphY3lh7rljrvnmoTmlbDph48KICAgIC8vIEV4YW1wbGU6IHsiVGVhbSI6IDIwMCwgIkNvbW11bml0eSI6IDgwMH0KCiAgICB0aGlzLmFsbG9jYXRlZEFtb3VudCA9IG5ldyBNYXAoKTsgLy8gYWxsb2NhdGVkQW1vdW50RGVsdGE6IOmhueebruWPkeihjOS7o+W4geW3sumAmui/hyBWZXN0IOWIhumFjeWHuuWOu+eahOaVsOmHjyDlop7ph4/mlbDmja4KCiAgICB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhID0gbmV3IE1hcCgpOyAvLyBhbGxvY2F0ZWRBbW91bnRUb3RhbDog6aG555uu5Y+R6KGM5Luj5biB5bey6YCa6L+HIFZlc3Qg5YiG6YWN5Ye65Y6755qE5oC76YePCgogICAgdGhpcy5hbGxvY2F0ZWRBbW91bnRUb3RhbCA9IDA7IC8vIGFsbG9jYXRpb25QZXJjZW50OiDpobnnm67ku6PluIHliIbphY3mlrnmoYgKICAgIC8vIEV4YW1wbGU6IHsiVGVhbSI6IDAuMiwgIkNvbW11bml0eSI6IDAuOH0KCiAgICB0aGlzLmFsbG9jYXRpb25QZXJjZW50ID0gbmV3IE1hcCgpOyAvLyBzdGFrZWRBbW91bnQ6IOS7o+W4geWcqOi0qOaKvOaxoOS4rei0qOaKvOeahOaVsOmHjwogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMTAwLCAiQ29tbXVuaXR5IjogMTAwfQoKICAgIHRoaXMuc3Rha2VkQW1vdW50ID0gbmV3IE1hcCgpOyAvLyBzdGFrZWRBbW91bnREZWx0YTog5Luj5biB5Zyo6LSo5oq85rGg5Lit6LSo5oq855qE5pWw6YePIOWinumHj+aVsOaNrgogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMCwgIkNvbW11bml0eSI6IDB9CgogICAgdGhpcy5zdGFrZWRBbW91bnREZWx0YSA9IG5ldyBNYXAoKTsgLy8gc3Rha2VkVG90YWw6IOS7o+W4geWcqOi0qOaKvOaxoOS4reeahOaAu+mHjwoKICAgIHRoaXMuc3Rha2VkVG90YWwgPSAwOyAvLyBmcmVlTW9uZXk6IOS7o+W4geWPr+S7peiHqueUsea1gemAmuS9v+eUqOeahOaVsOmHjwogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMTAwLCAiQ29tbXVuaXR5IjogNzAwfQoKICAgIHRoaXMuZnJlZU1vbmV5ID0gbmV3IE1hcCgpOyAvLyBmcmVlTW9uZXlEZWx0YTog5Luj5biB5Y+v5Lul6Ieq55Sx5rWB6YCa5L2/55So55qE5pWw6YePIOWinumHj+aVsOaNrgogICAgLy8gRXhhbXBsZTogeyJUZWFtIjogMCwgIkNvbW11bml0eSI6IDB9CgogICAgdGhpcy5mcmVlTW9uZXlEZWx0YSA9IG5ldyBNYXAoKTsgLy8gZnJlZU1vbmV5VG90YWw6IOS7o+W4geWPr+S7peiHqueUsea1gemAmueahOaAu+mHjwoKICAgIHRoaXMuZnJlZU1vbmV5VG90YWwgPSAwOwogICAgYWxsb2NhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAvLyDojrflj5YgYWxsb2NhdGlvblBlcmNlbnQg5pWw5o2uCiAgICAgIF90aGlzLmFsbG9jYXRpb25QZXJjZW50LnNldChlbGVtZW50Lm5hbWUsIE51bWJlcihlbGVtZW50LnByb3ApIC8gMTAwKTsKCiAgICAgIF90aGlzLmFsbG9jYXRlZEFtb3VudC5zZXQoZWxlbWVudC5uYW1lLCAwKTsKCiAgICAgIF90aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldChlbGVtZW50Lm5hbWUsIDApOwoKICAgICAgX3RoaXMuc3Rha2VkQW1vdW50LnNldChlbGVtZW50Lm5hbWUsIDApOwoKICAgICAgX3RoaXMuc3Rha2VkQW1vdW50RGVsdGEuc2V0KGVsZW1lbnQubmFtZSwgMCk7CgogICAgICBfdGhpcy5mcmVlTW9uZXkuc2V0KGVsZW1lbnQubmFtZSwgMCk7CgogICAgICBfdGhpcy5mcmVlTW9uZXlEZWx0YS5zZXQoZWxlbWVudC5uYW1lLCAwKTsKICAgIH0pOyAvLyBUT0RPIOi/mOmcgOimgeiAg+iZkSBwdWJsaWMgc2FsZSDpg6jliIYKICAgIC8vIGNvbW11bml0eVBvbGljeTogdG9rZW4g57uZ56S+5Yy65YiG6YWN5Luj5biB55qE562W55WlCgogICAgdGhpcy5jb21tdW5pdHlQb2xpY3kgPSB7CiAgICAgIGFsbG9jYXRpb25zOiBuZXcgTWFwKCksCiAgICAgIC8vIOekvuWMuuS7o+W4geeahOWIhumFjeavlOS+iyBFeGFtcGxlOiB7IkFpcmRyb3AiOiAwLjIsICJTdGFraW5nIjogMC44fQogICAgICBzdGFraW5nUG9vbDogMCwKICAgICAgLy8gVE9ETyBbRE9ORSwg6L+Y5Y+v5Lul5aaC5L2V5LyY5YyW77yfXSDlpoLkvZXmm7TmlrDov5nkuKogc3Rha2luZ1Bvb2w/IOWcqOWunuS+i+WMliBTdGFrZSDoioLngrnml7bvvIzmoLnmja7lhbYgcmV3YXJkUG9saWN5RnJvbSDlj4LmlbDmnaXmm7TmlLnlr7nlupQgdG9rZW4g55qEIHN0YWtpbmdQb29sIOWxnuaApyAKICAgICAgc3Rha2luZ1Jld2FyZExpZmV0aW1lOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdMaWZldGltZSksCiAgICAgIHN0YWtpbmdSZXdhcmRSZWZyZXNoUGVyaW9kOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdSZXdhcmRSZWZyZXNoKSwKICAgICAgc3Rha2luZ1Jld2FyZERlZmFjdG9yOiBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdSZXdhcmREZWNyZWFzZUZhY3RvcikgLyAxMDAKICAgIH07CiAgICBjb21tdW5pdHkuYWxsb2NhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICBfdGhpcy5jb21tdW5pdHlQb2xpY3kuYWxsb2NhdGlvbnMuc2V0KGVsZW1lbnQubmFtZSwgTnVtYmVyKGVsZW1lbnQucHJvcCkgLyAxMDApOwogICAgfSk7IC8vIGNhblZlc3Q6IHRva2VuIOaYr+WQpuWPr+S7pSB2ZXN0IAoKICAgIHRoaXMuY2FuVmVzdCA9IDE7IC8vIOekvuWMuueahOWPkeihjOetlueVpeS4reWPr+iDveacieebtOaOpeWvueWkluWPkeWUri/nqbrmipXnmoTluIEsIOi/memDqOWIhuW4geWcqOS4gOW8gOWni+WwseWxnuS6jiBmcmVlTW9uZXkKCiAgICBpZiAodGhpcy5jb21tdW5pdHlQb2xpY3kuYWxsb2NhdGlvbnMuaGFzKCJBaXJkcm9wIikpIHsKICAgICAgdmFyIGFtb3VudCA9IE51bWJlcigodGhpcy50b3RhbFN1cHBseSAqIHRoaXMuYWxsb2NhdGlvblBlcmNlbnQuZ2V0KCJDb21tdW5pdHkiKSAqIHRoaXMuY29tbXVuaXR5UG9saWN5LmFsbG9jYXRpb25zLmdldCgiQWlyZHJvcCIpKS50b0ZpeGVkKDQpKTsKICAgICAgdGhpcy5mcmVlTW9uZXkuc2V0KCJDb21tdW5pdHkiLCB0aGlzLmZyZWVNb25leS5nZXQoIkNvbW11bml0eSIpICsgYW1vdW50KTsKICAgICAgdGhpcy5mcmVlTW9uZXlUb3RhbCArPSBhbW91bnQ7CiAgICB9CgogICAgaWYgKHRoaXMuY29tbXVuaXR5UG9saWN5LmFsbG9jYXRpb25zLmhhcygiUHVibGljU2FsZSIpKSB7CiAgICAgIHZhciBfYW1vdW50ID0gTnVtYmVyKCh0aGlzLnRvdGFsU3VwcGx5ICogdGhpcy5hbGxvY2F0aW9uUGVyY2VudC5nZXQoIkNvbW11bml0eSIpICogdGhpcy5jb21tdW5pdHlQb2xpY3kuYWxsb2NhdGlvbnMuZ2V0KCJQdWJsaWNTYWxlIikpLnRvRml4ZWQoNCkpOwoKICAgICAgdGhpcy5mcmVlTW9uZXkuc2V0KCJDb21tdW5pdHkiLCB0aGlzLmZyZWVNb25leS5nZXQoIkNvbW11bml0eSIpICsgX2Ftb3VudCk7CiAgICAgIHRoaXMuZnJlZU1vbmV5VG90YWwgKz0gX2Ftb3VudDsKICAgIH0KCiAgICB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldCgiQ29tbXVuaXR5IiwgTnVtYmVyKCh0aGlzLmFsbG9jYXRpb25QZXJjZW50LmdldCgiQ29tbXVuaXR5IikgKiB0aGlzLnRvdGFsU3VwcGx5KS50b0ZpeGVkKDQpKSk7CiAgfSAvLyDmiafooYzmtYvnrpfpgLvovpEKCgogIF9jcmVhdGVDbGFzcyhUb2tlbiwgW3sKICAgIGtleTogInJ1biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcnVuKHByZU5vZGUsIGN1ckRheSkgewogICAgICAvLyDlpoLmnpzmsqHmnInliY3luo/oioLngrnvvIzliJnkuI3kvJrmiafooYzmtYvnrpfpgLvovpEKICAgICAgaWYgKHByZU5vZGUgPT0gbnVsbCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHByZU5vZGUuY29uc3RydWN0b3IgPT09IFRva2VuKSB7CiAgICAgICAgLy8gVE9ETyBUb2tlbiDoioLngrnnmoTliY3luo/oioLngrnmmK8gVG9rZW4g55qE5oOF5Ya15pqC5pe25LiN5aSE55CGCiAgICAgICAgcmV0dXJuOwogICAgICB9IGVsc2UgaWYgKHByZU5vZGUuY29uc3RydWN0b3IgPT09IFN0YWtlKSB7CiAgICAgICAgLy8g5oqK5YmN5bqPIFN0YWtlIOiKgueCueWIhumFjeeahCByZXdhcmQg5Yqg5Yiw6Ieq6Lqr55qEIGZyZWVNb25leURlbHRhIOWinumHj+aVsOaNruS4igogICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leURlbHRhKSwKICAgICAgICAgICAgX3N0ZXA7CgogICAgICAgIHRyeSB7CiAgICAgICAgICBmb3IgKF9pdGVyYXRvci5zKCk7ICEoX3N0ZXAgPSBfaXRlcmF0b3IubigpKS5kb25lOykgewogICAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwLnZhbHVlOwoKICAgICAgICAgICAgaWYgKHByZU5vZGUucmV3YXJkQWxsb2NhdGVkRGVsdGEuaGFzKGl0ZW1bMF0pKSB7CiAgICAgICAgICAgICAgaXRlbVsxXSArPSBwcmVOb2RlLnJld2FyZEFsbG9jYXRlZERlbHRhLmdldChpdGVtWzBdKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgdGhpcy5mcmVlTW9uZXlEZWx0YS5zZXQoaXRlbVswXSwgaXRlbVsxXSk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICBfaXRlcmF0b3IuZigpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChwcmVOb2RlLmNvbnN0cnVjdG9yID09PSBVbnN0YWtlKSB7CiAgICAgICAgLy8g5aaC5p6c5YmN5bqPIHVuc3Rha2Ug6IqC54K555qEIHVuc3Rha2VIaXN0b3J5IOS4reacieW9k+WkqeeahOmHiuaUvuiusOW9le+8jOWImeaKiumHiuaUvueahOW4geWKoOWIsOiHqui6q+eahCBmcmVlTW9uZXlEZWx0YSDkuIoKICAgICAgICBpZiAocHJlTm9kZS51bnN0YWtlSGlzdG9yeS5oYXMoY3VyRGF5KSkgewogICAgICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leURlbHRhKSwKICAgICAgICAgICAgICBfc3RlcDI7CgogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgICB2YXIgX2l0ZW0gPSBfc3RlcDIudmFsdWU7CgogICAgICAgICAgICAgIGlmIChwcmVOb2RlLnVuc3Rha2VIaXN0b3J5LmdldChjdXJEYXkpLmhhcyhfaXRlbVswXSkpIHsKICAgICAgICAgICAgICAgIF9pdGVtWzFdICs9IHByZU5vZGUudW5zdGFrZUhpc3RvcnkuZ2V0KGN1ckRheSkuZ2V0KF9pdGVtWzBdKTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHRoaXMuZnJlZU1vbmV5RGVsdGEuc2V0KF9pdGVtWzBdLCBfaXRlbVsxXSk7CiAgICAgICAgICAgIH0gLy8gVE9ETyB2ZXN0SGlzdG9yeSDmmoLml7bkuI3og73liKDpmaTvvIzlkKbliJnml6Dms5XlnKjmlbDmja7lj6/op4bljJbpnaLmnb/nnIvliLDmnInmlYjmlbDmja4KICAgICAgICAgICAgLy8gcHJlTm9kZS51bnN0YWtlSGlzdG9yeS5kZWxldGUoY3VyRGF5KTsKCiAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAocHJlTm9kZS5jb25zdHJ1Y3RvciA9PT0gVmVzdCkgewogICAgICAgIC8vIOWmguaenOWJjeW6jyB2ZXN0IOiKgueCueeahCB2ZXN0SGlzdG9yeSDkuK3mnInlvZPlpKnnmoTph4rmlL7orrDlvZXvvIzliJnmiorph4rmlL7nmoTluIHliqDliLDoh6rouqvnmoQgZnJlZU1vbmV5RGVsdGEg5LiKCiAgICAgICAgaWYgKHByZU5vZGUudmVzdEhpc3RvcnkuaGFzKGN1ckRheSkpIHsKICAgICAgICAgIHZhciBfaXRlcmF0b3IzID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5mcmVlTW9uZXlEZWx0YSksCiAgICAgICAgICAgICAgX3N0ZXAzOwoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgdmFyIF9pdGVtMiA9IF9zdGVwMy52YWx1ZTsKCiAgICAgICAgICAgICAgaWYgKHByZU5vZGUudmVzdEhpc3RvcnkuZ2V0KGN1ckRheSkuaGFzKF9pdGVtMlswXSkpIHsKICAgICAgICAgICAgICAgIF9pdGVtMlsxXSArPSBwcmVOb2RlLnZlc3RIaXN0b3J5LmdldChjdXJEYXkpLmdldChfaXRlbTJbMF0pOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5mcmVlTW9uZXlEZWx0YS5zZXQoX2l0ZW0yWzBdLCBfaXRlbTJbMV0pOwogICAgICAgICAgICB9IC8vIFRPRE8gdmVzdEhpc3Rvcnkg5pqC5pe25LiN6IO95Yig6Zmk77yM5ZCm5YiZ5peg5rOV5Zyo5pWw5o2u5Y+v6KeG5YyW6Z2i5p2/55yL5Yiw5pyJ5pWI5pWw5o2uCiAgICAgICAgICAgIC8vIHByZU5vZGUudmVzdEhpc3RvcnkuZGVsZXRlKGN1ckRheSk7CgogICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgIF9pdGVyYXRvcjMuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yMy5mKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2Ugey8vIGxvZyDmj5DnpLrmiqXplJk6IOS4jeaUr+aMgeeahOiKgueCueexu+WeiwogICAgICAgIH0KICAgIH0gLy8g5omn6KGMIERlbHRhIOaVsOaNruWIsCBDb21taXQg5pWw5o2u55qE5pu05pawCgogIH0sIHsKICAgIGtleTogInVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlKCkgewogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IGZyZWVNb25leURlbHRhOiIsIHRoaXMuZnJlZU1vbmV5RGVsdGEpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IHN0YWtlZEFtb3VudERlbHRhOiIsIHRoaXMuc3Rha2VkQW1vdW50RGVsdGEpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IGFsbG9jYXRlZEFtb3VudERlbHRhOiIsIHRoaXMuYWxsb2NhdGVkQW1vdW50RGVsdGEpOyAvLyDmiafooYwgc3Rha2VkQW1vdW50IOeahOaVsOaNruabtOaWsCwg5bm26YeN572u5aKe6YeP5pWw5o2uCgogICAgICB2YXIgX2l0ZXJhdG9yNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoaXMuc3Rha2VkQW1vdW50LmVudHJpZXMoKSksCiAgICAgICAgICBfc3RlcDQ7CgogICAgICB0cnkgewogICAgICAgIGZvciAoX2l0ZXJhdG9yNC5zKCk7ICEoX3N0ZXA0ID0gX2l0ZXJhdG9yNC5uKCkpLmRvbmU7KSB7CiAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwNC52YWx1ZTsKICAgICAgICAgIGl0ZW1bMV0gKz0gdGhpcy5zdGFrZWRBbW91bnREZWx0YS5nZXQoaXRlbVswXSk7CiAgICAgICAgICB0aGlzLnN0YWtlZEFtb3VudC5zZXQoaXRlbVswXSwgaXRlbVsxXSk7CiAgICAgICAgICB0aGlzLnN0YWtlZFRvdGFsICs9IHRoaXMuc3Rha2VkQW1vdW50RGVsdGEuZ2V0KGl0ZW1bMF0pOwogICAgICAgICAgdGhpcy5zdGFrZWRBbW91bnREZWx0YS5zZXQoaXRlbVswXSwgMCk7CiAgICAgICAgfSAvLyDmiafooYwgZnJlZU1vbmV5IOeahOaVsOaNruabtOaWsCwg5bm26YeN572u5aKe6YeP5pWw5o2uCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I0LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I0LmYoKTsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcih0aGlzLmZyZWVNb25leS5lbnRyaWVzKCkpLAogICAgICAgICAgX3N0ZXA1OwoKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgdmFyIF9pdGVtMyA9IF9zdGVwNS52YWx1ZTsKICAgICAgICAgIF9pdGVtM1sxXSArPSB0aGlzLmZyZWVNb25leURlbHRhLmdldChfaXRlbTNbMF0pOwogICAgICAgICAgdGhpcy5mcmVlTW9uZXkuc2V0KF9pdGVtM1swXSwgX2l0ZW0zWzFdKTsKICAgICAgICAgIHRoaXMuZnJlZU1vbmV5VG90YWwgKz0gdGhpcy5mcmVlTW9uZXlEZWx0YS5nZXQoX2l0ZW0zWzBdKTsKICAgICAgICAgIHRoaXMuZnJlZU1vbmV5RGVsdGEuc2V0KF9pdGVtM1swXSwgMCk7CiAgICAgICAgfSAvLyDmiafooYwgYWxsb2NhdGVkQW1vdW50IOeahOaVsOaNruabtOaWsO+8jOW5tumHjee9ruWinumHj+aVsOaNrgoKICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNS5mKCk7CiAgICAgIH0KCiAgICAgIHZhciBfaXRlcmF0b3I2ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhpcy5hbGxvY2F0ZWRBbW91bnQuZW50cmllcygpKSwKICAgICAgICAgIF9zdGVwNjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I2LnMoKTsgIShfc3RlcDYgPSBfaXRlcmF0b3I2Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBfaXRlbTQgPSBfc3RlcDYudmFsdWU7CiAgICAgICAgICBfaXRlbTRbMV0gKz0gdGhpcy5hbGxvY2F0ZWRBbW91bnREZWx0YS5nZXQoX2l0ZW00WzBdKTsKICAgICAgICAgIHRoaXMuYWxsb2NhdGVkQW1vdW50LnNldChfaXRlbTRbMF0sIF9pdGVtNFsxXSk7CiAgICAgICAgICB0aGlzLmFsbG9jYXRlZEFtb3VudFRvdGFsICs9IHRoaXMuYWxsb2NhdGVkQW1vdW50RGVsdGEuZ2V0KF9pdGVtNFswXSk7CiAgICAgICAgICB0aGlzLmFsbG9jYXRlZEFtb3VudERlbHRhLnNldChfaXRlbTRbMF0sIDApOwogICAgICAgIH0gLy8g5a+55LqO5pyJ5Y+R6KGM6YeP55qE5biB77yM6ZyA6KaB5pu05pawIGNhblZlc3Qg5Y+C5pWwCgogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I2LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I2LmYoKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMudG90YWxTdXBwbHkgPiAwKSB7CiAgICAgICAgaWYgKHRoaXMuYWxsb2NhdGVkQW1vdW50VG90YWwgPCB0aGlzLnRvdGFsU3VwcGx5KSB7CiAgICAgICAgICAvLyDlvZPlt7LpgJrov4cgVmVzdCDliIbphY3lh7rljrvnmoTph4/lsI/kuo7lj5HooYzmgLvph4/ml7bvvIzlhYHorrjnu6fnu60gdmVzdAogICAgICAgICAgdGhpcy5jYW5WZXN0ID0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5b2T5bey6YCa6L+HIFZlc3Qg5YiG6YWN5Ye65Y6755qE6YeP5aSn5LqO562J5LqO5Y+R6KGM5oC76YeP5pe277yM5LiN5YWB6K6457un57utIHZlc3QKICAgICAgICAgIHRoaXMuY2FuVmVzdCA9IDA7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IHN0YWtlZEFtb3VudDoiLCB0aGlzLnN0YWtlZEFtb3VudCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3ltYm9sLCAiOjp0b2tlbjogc3Rha2VkVG90YWw6IiwgdGhpcy5zdGFrZWRUb3RhbCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3ltYm9sLCAiOjp0b2tlbjogZnJlZU1vbmV5OiIsIHRoaXMuZnJlZU1vbmV5KTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBmcmVlTW9uZXlUb3RhbDoiLCB0aGlzLmZyZWVNb25leVRvdGFsKTsKICAgICAgY29uc29sZS5sb2codGhpcy5zeW1ib2wsICI6OnRva2VuOiBhbGxvY2F0ZWRBbW91bnQ6IiwgdGhpcy5hbGxvY2F0ZWRBbW91bnQpOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnN5bWJvbCwgIjo6dG9rZW46IGFsbG9jYXRlZEFtb3VudFRvdGFsOiIsIHRoaXMuYWxsb2NhdGVkQW1vdW50VG90YWwpOwogICAgfSAvLyAg5pu05paw5bey5a2Y5Zyo55qEIFRva2VuIOWunuS+i+mHjOeahOWPguaVsAoKICB9LCB7CiAgICBrZXk6ICJzZWxmVXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxmVXBkYXRlKHN5bWJvbCwgdG90YWxTdXBwbHksIGFsbG9jYXRpb25zLCBjb21tdW5pdHkpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLnN5bWJvbCA9IHN5bWJvbDsKICAgICAgdGhpcy50b3RhbFN1cHBseSA9IHRvdGFsU3VwcGx5OwogICAgICBhbGxvY2F0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICAgICAgLy8g5pu05pawIGFsbG9jYXRpb25QZXJjZW50IOaVsOaNrgogICAgICAgIF90aGlzMi5hbGxvY2F0aW9uUGVyY2VudC5zZXQoZWxlbWVudC5uYW1lLCBOdW1iZXIoZWxlbWVudC5wcm9wKSAvIDEwMCk7CiAgICAgIH0pOwogICAgICB0aGlzLmNvbW11bml0eVBvbGljeS5zdGFraW5nUmV3YXJkTGlmZXRpbWUgPSBOdW1iZXIoY29tbXVuaXR5LnN0YWtpbmdMaWZldGltZSk7CiAgICAgIHRoaXMuY29tbXVuaXR5UG9saWN5LnN0YWtpbmdSZXdhcmRSZWZyZXNoUGVyaW9kID0gTnVtYmVyKGNvbW11bml0eS5zdGFraW5nUmV3YXJkUmVmcmVzaCk7CiAgICAgIHRoaXMuY29tbXVuaXR5UG9saWN5LnN0YWtpbmdSZXdhcmREZWZhY3RvciA9IE51bWJlcihjb21tdW5pdHkuc3Rha2luZ1Jld2FyZERlY3JlYXNlRmFjdG9yKSAvIDEwMDsKICAgICAgY29tbXVuaXR5LmFsbG9jYXRpb25zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHsKICAgICAgICBfdGhpczIuY29tbXVuaXR5UG9saWN5LmFsbG9jYXRpb25zLnNldChlbGVtZW50Lm5hbWUsIE51bWJlcihlbGVtZW50LnByb3ApIC8gMTAwKTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gVG9rZW47Cn0oKTs="},{"version":3,"sources":["/Users/wangxufei/Desktop/FlowModel/src/graph/token.js"],"names":["Stake","Unstake","Vest","Token","symbol","totalSupply","allocations","community","Number","allocatedAmount","Map","allocatedAmountDelta","allocatedAmountTotal","allocationPercent","stakedAmount","stakedAmountDelta","stakedTotal","freeMoney","freeMoneyDelta","freeMoneyTotal","forEach","element","set","name","prop","communityPolicy","stakingPool","stakingRewardLifetime","stakingLifetime","stakingRewardRefreshPeriod","stakingRewardRefresh","stakingRewardDefactor","stakingRewardDecreaseFactor","canVest","has","amount","get","toFixed","preNode","curDay","constructor","item","rewardAllocatedDelta","unstakeHistory","vestHistory","console","log","entries"],"mappings":"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","sourcesContent":["import { Stake, Unstake, Vest } from \"./action\";\n\nexport class Token {\n\n    // constructor\n    // params:\n    //      symbol: \"Apex\",\n    //      totalSupply: 1000000,\n    //      allocations: [\n    //          { name: \"Team\", prop: 0, class: \"team-slider\" },\n    //          { name: \"Investor\", prop: 0, class: \"investor-slider\" },\n    //          { name: \"Advisor\", prop: 0, class: \"advisor-slider\" },\n    //          { name: \"Foundation\", prop: 0, class: \"foundation-slider\" },\n    //          { name: \"Community\", prop: 0, class: \"community-slider\" },\n    //      ],\n    //      community: {\n    //          allocations: [\n    //              { name: \"Airdrop\", prop: 0, class: \"airdrop-turntable\" },\n    //              { name: \"Staking\", prop: 0, class: \"staking-turntable\" },\n    //          ],\n    //          stakingLifetime: 0,\n    //          stakingRewardRefresh: 0,\n    //          stakingRewardDecreaseFactor: 0,\n    //      },\n    constructor(symbol, totalSupply, allocations, community) {\n        this.symbol = symbol;\n        this.totalSupply = Number(totalSupply);\n\n        // TODO stakedPercent 是否必要?\n        // TODO freeMoneyPercent 是否必要？\n\n        // allocatedAmount: 项目发行代币已通过 Vest 分配出去的数量\n        // Example: {\"Team\": 200, \"Community\": 800}\n        this.allocatedAmount = new Map();\n        // allocatedAmountDelta: 项目发行代币已通过 Vest 分配出去的数量 增量数据\n        this.allocatedAmountDelta = new Map();\n        // allocatedAmountTotal: 项目发行代币已通过 Vest 分配出去的总量\n        this.allocatedAmountTotal = 0;\n        // allocationPercent: 项目代币分配方案\n        // Example: {\"Team\": 0.2, \"Community\": 0.8}\n        this.allocationPercent = new Map();\n        // stakedAmount: 代币在质押池中质押的数量\n        // Example: {\"Team\": 100, \"Community\": 100}\n        this.stakedAmount = new Map();\n        // stakedAmountDelta: 代币在质押池中质押的数量 增量数据\n        // Example: {\"Team\": 0, \"Community\": 0}\n        this.stakedAmountDelta = new Map();\n        // stakedTotal: 代币在质押池中的总量\n        this.stakedTotal = 0;\n        // freeMoney: 代币可以自由流通使用的数量\n        // Example: {\"Team\": 100, \"Community\": 700}\n        this.freeMoney = new Map();\n        // freeMoneyDelta: 代币可以自由流通使用的数量 增量数据\n        // Example: {\"Team\": 0, \"Community\": 0}\n        this.freeMoneyDelta = new Map();\n        // freeMoneyTotal: 代币可以自由流通的总量\n        this.freeMoneyTotal = 0;\n\n        allocations.forEach(element => {\n            // 获取 allocationPercent 数据\n            this.allocationPercent.set(element.name, Number(element.prop) / 100);    \n\n            this.allocatedAmount.set(element.name, 0);\n            this.allocatedAmountDelta.set(element.name, 0);\n            this.stakedAmount.set(element.name, 0);\n            this.stakedAmountDelta.set(element.name, 0);\n            this.freeMoney.set(element.name, 0);\n            this.freeMoneyDelta.set(element.name, 0);\n        })\n\n        // TODO 还需要考虑 public sale 部分\n        // communityPolicy: token 给社区分配代币的策略\n        this.communityPolicy = {\n            allocations: new Map(), // 社区代币的分配比例 Example: {\"Airdrop\": 0.2, \"Staking\": 0.8}\n            stakingPool:                0, // TODO [DONE, 还可以如何优化？] 如何更新这个 stakingPool? 在实例化 Stake 节点时，根据其 rewardPolicyFrom 参数来更改对应 token 的 stakingPool 属性 \n            stakingRewardLifetime:      Number(community.stakingLifetime),\n            stakingRewardRefreshPeriod: Number(community.stakingRewardRefresh),\n            stakingRewardDefactor:      Number(community.stakingRewardDecreaseFactor) / 100,\n        }\n\n        community.allocations.forEach(element => {\n            this.communityPolicy.allocations.set(element.name, Number(element.prop) / 100);\n        })\n\n        // canVest: token 是否可以 vest \n        this.canVest = 1;\n\n        // 社区的发行策略中可能有直接对外发售/空投的币, 这部分币在一开始就属于 freeMoney\n        if (this.communityPolicy.allocations.has(\"Airdrop\") ) {\n            let amount = Number((this.totalSupply * this.allocationPercent.get(\"Community\") * this.communityPolicy.allocations.get(\"Airdrop\")).toFixed(4));\n            this.freeMoney.set(\"Community\", this.freeMoney.get(\"Community\") + amount);\n            this.freeMoneyTotal += amount;\n        }\n        if (this.communityPolicy.allocations.has(\"PublicSale\")) {\n            let amount = Number((this.totalSupply * this.allocationPercent.get(\"Community\") * this.communityPolicy.allocations.get(\"PublicSale\")).toFixed(4));\n            this.freeMoney.set(\"Community\", this.freeMoney.get(\"Community\") + amount);\n            this.freeMoneyTotal += amount;\n        }\n        this.allocatedAmountDelta.set(\"Community\", Number((this.allocationPercent.get(\"Community\") * this.totalSupply).toFixed(4)));\n    }\n\n    // 执行测算逻辑\n    run(preNode, curDay) {\n\n        // 如果没有前序节点，则不会执行测算逻辑\n        if (preNode == null) {\n            return ;\n        }\n\n        if (preNode.constructor === Token) {\n            // TODO Token 节点的前序节点是 Token 的情况暂时不处理\n            return ;\n        } \n        else if (preNode.constructor === Stake) {\n            // 把前序 Stake 节点分配的 reward 加到自身的 freeMoneyDelta 增量数据上\n            for (let item of this.freeMoneyDelta) {\n                if (preNode.rewardAllocatedDelta.has(item[0])) {\n                    item[1] += preNode.rewardAllocatedDelta.get(item[0]);\n                }\n                \n                this.freeMoneyDelta.set(item[0], item[1]);\n            }\n            \n        } \n        else if (preNode.constructor === Unstake) {\n            // 如果前序 unstake 节点的 unstakeHistory 中有当天的释放记录，则把释放的币加到自身的 freeMoneyDelta 上\n            if (preNode.unstakeHistory.has(curDay)) {\n                for (let item of this.freeMoneyDelta) {\n                    if (preNode.unstakeHistory.get(curDay).has(item[0])) {\n                        item[1] += preNode.unstakeHistory.get(curDay).get(item[0]);\n                    }\n                    this.freeMoneyDelta.set(item[0], item[1]);\n                }\n\n                // TODO vestHistory 暂时不能删除，否则无法在数据可视化面板看到有效数据\n                // preNode.unstakeHistory.delete(curDay);\n            }\n        } \n        else if (preNode.constructor === Vest) {\n            // 如果前序 vest 节点的 vestHistory 中有当天的释放记录，则把释放的币加到自身的 freeMoneyDelta 上\n            if (preNode.vestHistory.has(curDay)) {\n                for (let item of this.freeMoneyDelta) {\n                    if (preNode.vestHistory.get(curDay).has(item[0])) {\n                        item[1] += preNode.vestHistory.get(curDay).get(item[0]);\n                    }\n                    this.freeMoneyDelta.set(item[0], item[1]);\n                }\n\n                // TODO vestHistory 暂时不能删除，否则无法在数据可视化面板看到有效数据\n                // preNode.vestHistory.delete(curDay);\n            }\n        }\n        else {\n            // log 提示报错: 不支持的节点类型\n        }\n\n    }\n\n    // 执行 Delta 数据到 Commit 数据的更新\n    update() {\n        console.log(this.symbol, \"::token: freeMoneyDelta:\", this.freeMoneyDelta);\n        console.log(this.symbol, \"::token: stakedAmountDelta:\", this.stakedAmountDelta);\n        console.log(this.symbol, \"::token: allocatedAmountDelta:\", this.allocatedAmountDelta);\n        // 执行 stakedAmount 的数据更新, 并重置增量数据\n        for(let item of this.stakedAmount.entries()) {\n            item[1] += this.stakedAmountDelta.get(item[0]);\n            this.stakedAmount.set(item[0], item[1]);\n            this.stakedTotal += this.stakedAmountDelta.get(item[0]);\n            this.stakedAmountDelta.set(item[0], 0);\n        }\n\n        // 执行 freeMoney 的数据更新, 并重置增量数据\n        for(let item of this.freeMoney.entries()) {\n            item[1] += this.freeMoneyDelta.get(item[0]);\n            this.freeMoney.set(item[0], item[1]);\n            this.freeMoneyTotal += this.freeMoneyDelta.get(item[0]);\n            this.freeMoneyDelta.set(item[0], 0);\n        }\n\n        // 执行 allocatedAmount 的数据更新，并重置增量数据\n        for(let item of this.allocatedAmount.entries()) {\n            item[1] += this.allocatedAmountDelta.get(item[0]);\n            this.allocatedAmount.set(item[0], item[1]);\n            this.allocatedAmountTotal += this.allocatedAmountDelta.get(item[0]);\n            this.allocatedAmountDelta.set(item[0], 0);\n        }\n       \n        // 对于有发行量的币，需要更新 canVest 参数\n        if (this.totalSupply > 0) {\n            if (this.allocatedAmountTotal < this.totalSupply) {\n                // 当已通过 Vest 分配出去的量小于发行总量时，允许继续 vest\n                this.canVest = 1;\n            } else {\n                // 当已通过 Vest 分配出去的量大于等于发行总量时，不允许继续 vest\n                this.canVest = 0;\n            }\n        }\n\n        console.log(this.symbol, \"::token: stakedAmount:\", this.stakedAmount);\n        \n        console.log(this.symbol, \"::token: stakedTotal:\", this.stakedTotal);\n        console.log(this.symbol, \"::token: freeMoney:\", this.freeMoney);\n    \n        console.log(this.symbol, \"::token: freeMoneyTotal:\", this.freeMoneyTotal);\n        console.log(this.symbol, \"::token: allocatedAmount:\", this.allocatedAmount);\n        \n        console.log(this.symbol, \"::token: allocatedAmountTotal:\", this.allocatedAmountTotal);\n    }\n\n    //  更新已存在的 Token 实例里的参数\n    selfUpdate(symbol, totalSupply, allocations, community) {\n        this.symbol = symbol;\n        this.totalSupply = totalSupply;\n\n        allocations.forEach(element => {\n            // 更新 allocationPercent 数据\n            this.allocationPercent.set(element.name, Number(element.prop) / 100);    \n        })\n\n        this.communityPolicy.stakingRewardLifetime = Number(community.stakingLifetime);\n        this.communityPolicy.stakingRewardRefreshPeriod = Number(community.stakingRewardRefresh);\n        this.communityPolicy.stakingRewardDefactor = Number(community.stakingRewardDecreaseFactor) / 100;\n\n        community.allocations.forEach(element => {\n            this.communityPolicy.allocations.set(element.name, Number(element.prop) / 100);\n        })\n    }\n}\n"]}]}