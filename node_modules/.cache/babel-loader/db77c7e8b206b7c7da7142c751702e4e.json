{"remainingRequest":"/Users/xufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js!/Users/xufei/Desktop/FlowModel/node_modules/eslint-loader/index.js??ref--13-0!/Users/xufei/Desktop/FlowModel/src/graph/propertyVisitor.js","dependencies":[{"path":"/Users/xufei/Desktop/FlowModel/src/graph/propertyVisitor.js","mtime":1653708835727},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/cache-loader/dist/cjs.js","mtime":1653708689072},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/babel-loader/lib/index.js","mtime":1653708688758},{"path":"/Users/xufei/Desktop/FlowModel/node_modules/eslint-loader/index.js","mtime":1653708690128}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnNldCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgZnJvbSAiL1VzZXJzL3h1ZmVpL0Rlc2t0b3AvRmxvd01vZGVsL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvVXNlcnMveHVmZWkvRGVza3RvcC9GbG93TW9kZWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvVXNlcnMveHVmZWkvRGVza3RvcC9GbG93TW9kZWwvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IHsgVGltZUNvbnRleHQsIFJvbGVDb250ZXh0LCBFeHByQ29udGV4dCB9IGZyb20gIi4uL3BhcnNlci9Qcm9wZXJ0eVBhcnNlciI7CmV4cG9ydCB2YXIgUHJvcGVydHlWaXNpdG9yID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBQcm9wZXJ0eVZpc2l0b3IoZW5kRGF5LCBkYXRhLCBub2RlcykgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFByb3BlcnR5VmlzaXRvcik7CgogICAgdGhpcy5zdGF0ZSA9IDA7CiAgICB0aGlzLmVuZERheSA9IGVuZERheTsKICAgIHRoaXMuZGF0YSA9IGRhdGE7CiAgICB0aGlzLm5vZGVzID0gbmV3IFNldCgpOwoKICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihub2RlcyksCiAgICAgICAgX3N0ZXA7CgogICAgdHJ5IHsKICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICB2YXIgaXRlbSA9IF9zdGVwLnZhbHVlOwogICAgICAgIHRoaXMubm9kZXMuYWRkKGl0ZW0ubGFiZWwpOwogICAgICB9CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgX2l0ZXJhdG9yLmUoZXJyKTsKICAgIH0gZmluYWxseSB7CiAgICAgIF9pdGVyYXRvci5mKCk7CiAgICB9CgogICAgdGhpcy5ub2RlID0gIiI7CiAgICB0aGlzLnJvbGUgPSAiIjsKICB9CgogIF9jcmVhdGVDbGFzcyhQcm9wZXJ0eVZpc2l0b3IsIFt7CiAgICBrZXk6ICJ2aXNpdENoaWxkcmVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB2aXNpdENoaWxkcmVuKGN0eCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKCFjdHgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChjdHguY2hpbGRyZW4pIHsKICAgICAgICByZXR1cm4gY3R4LmNoaWxkcmVuLm1hcChmdW5jdGlvbiAoY2hpbGQpIHsKICAgICAgICAgIGlmIChjaGlsZC5jaGlsZHJlbiAmJiBjaGlsZC5jaGlsZHJlbi5sZW5ndGggIT0gMCkgewogICAgICAgICAgICByZXR1cm4gY2hpbGQuYWNjZXB0KF90aGlzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGNoaWxkKTsgLy8g5b2T5aSE55CGIFRpbWUg6K+t5rOV5pe2IGVnLiAiQWZ0ZXIgMTAwIGRheXMiCgogICAgICAgICAgICBpZiAoY2hpbGQucGFyZW50Q3R4IGluc3RhbmNlb2YgVGltZUNvbnRleHQpIHsKICAgICAgICAgICAgICAvLyBUaW1lIOivreazleS4iuS4i+aWh+S4rSDkuIvmoIfkuLogMSDnmoTor43mmK/miJHku6zpnIDopoHnmoQKICAgICAgICAgICAgICBpZiAoY2hpbGQgPT0gY2hpbGQucGFyZW50Q3R4LmNoaWxkcmVuWzFdKSB7CiAgICAgICAgICAgICAgICB2YXIgdG1wVmFsdWUgPSBjaGlsZC5zeW1ib2wudGV4dDsgLy8g5Yik5pat5rWL566X5qih5Z6L5rWL566X55qE5pe26Ze05piv5ZCm5bey6L6+5YiwIHByb3BlcnR5IOS4reinhOWumueahOaXtumXtAoKICAgICAgICAgICAgICAgIGlmIChwYXJzZUludCh0bXBWYWx1ZSkgPD0gX3RoaXMuZW5kRGF5KSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IC8vIOW9k+WkhOeQhiBSb2xlIOivreazleaXtiBlZy4gIkFWQVguVG9rZW4iCiAgICAgICAgICAgIGVsc2UgaWYgKGNoaWxkLnBhcmVudEN0eCBpbnN0YW5jZW9mIFJvbGVDb250ZXh0KSB7CiAgICAgICAgICAgICAgICBpZiAoY2hpbGQgPT0gY2hpbGQucGFyZW50Q3R4LmNoaWxkcmVuWzBdKSB7CiAgICAgICAgICAgICAgICAgIC8vIOWIpOaWrSBub2RlIOiKgueCueWQjeensOaYr+WQpuWQiOazlQogICAgICAgICAgICAgICAgICBpZiAoX3RoaXMubm9kZXMuaGFzKGNoaWxkLnN5bWJvbC50ZXh0KSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlKys7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIF90aGlzLm5vZGUgPSBjaGlsZC5zeW1ib2wudGV4dDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoY2hpbGQgPT0gY2hpbGQucGFyZW50Q3R4LmNoaWxkcmVuWzJdKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnJvbGUgPSBjaGlsZC5zeW1ib2wudGV4dDsgLy8g5qC55o2u5bey6I635Y+W55qEIG5vZGUg6IqC54K55ZCN5a2X5ZKMIHJvbGUg6KeS6Imy5ZCN5a2X77yM5L+d55WZ5rWL566X5pWw5o2u5Lit55u45YWz55qE6YOo5YiG5pWw5o2uCgogICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF90aGlzLmRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAvLyDmib7liLAgbm9kZSDoioLngrnnmoTmlbDmja4KICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuZGF0YVtpXS50eXBlID09IF90aGlzLm5vZGUpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIOe7hOijheacieaViOeahOaVsOaNrgogICAgICAgICAgICAgICAgICAgICAgdmFyIHRtcCA9IG5ldyBNYXAoKTsgLy8ge3R5cGU6ICJUZWFtIiwgZGF0YToge+a1i+eul+aVsOaNruS4reacgOWQjuS4gOWkqeeahOaVsOaNrn19CgogICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBfdGhpcy5kYXRhW2ldLmRhdGEubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g5Yik5patIHJvbGUg5ZCN56ew5piv5ZCm5ZCI5rOVCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5yb2xlID09IF90aGlzLmRhdGFbaV0uZGF0YVtqXS50eXBlKSBfdGhpcy5zdGF0ZSsrOwogICAgICAgICAgICAgICAgICAgICAgICB0bXAuc2V0KF90aGlzLmRhdGFbaV0uZGF0YVtqXS50eXBlLCBfdGhpcy5kYXRhW2ldLmRhdGFbal0uZGF0YVtfdGhpcy5kYXRhW2ldLmRhdGFbal0uZGF0YS5sZW5ndGggLSAxXSk7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZGF0YSA9IHRtcDsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGQucGFyZW50Q3R4IGluc3RhbmNlb2YgRXhwckNvbnRleHQpIHsKICAgICAgICAgICAgICAgIGlmIChjaGlsZCA9PSBjaGlsZC5wYXJlbnRDdHguY2hpbGRyZW5bMF0pIHsKICAgICAgICAgICAgICAgICAgLy8g6K6h566X5b2T5YmNIG5vZGUg5Lit5omA5pyJIHJvbGUg5pWw5YC855qE5oC75ZKM77yM5pa55L6/5ZCO57ut5a+55LiN5ZCMIHJvbGUg55qE5Y2g5q+U6L+b6KGM6K6h566XCiAgICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IE51bWJlcigwKTsKCiAgICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3IyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoX3RoaXMuZGF0YSksCiAgICAgICAgICAgICAgICAgICAgICBfc3RlcDI7CgogICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yMi5zKCk7ICEoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgIHRvdGFsICs9IE51bWJlcihpdGVtWzFdLnZhbHVlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZShlcnIpOwogICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIuZigpOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoaWxkLnBhcmVudEN0eC5jaGlsZHJlblswXS5zeW1ib2wudGV4dCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgIj49IjoKICAgICAgICAgICAgICAgICAgICAgIC8vIOiuoeeul+W9k+WJjSBub2RlIOiKgueCueS4iyByb2xlIOinkuiJsueahOaVsOaNruWNoOavlOaYr+WQpua7oei2syA+PSDnmoTmnaHku7YKICAgICAgICAgICAgICAgICAgICAgIGlmIChOdW1iZXIoX3RoaXMuZGF0YS5nZXQoX3RoaXMucm9sZSkudmFsdWUpIC8gdG90YWwgKiAxMDAgPj0gTnVtYmVyKGNoaWxkLnBhcmVudEN0eC5jaGlsZHJlblsxXS5zeW1ib2wudGV4dCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhdGUrKzsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgY2FzZSAiPT0iOgogICAgICAgICAgICAgICAgICAgICAgaWYgKE51bWJlcihfdGhpcy5kYXRhLmdldChfdGhpcy5yb2xlKS52YWx1ZSkgLyB0b3RhbCAqIDEwMCA9PSBOdW1iZXIoY2hpbGQucGFyZW50Q3R4LmNoaWxkcmVuWzFdLnN5bWJvbC50ZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zdGF0ZSsrOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICAgICAgICBjYXNlICI8PSI6CiAgICAgICAgICAgICAgICAgICAgICBpZiAoTnVtYmVyKF90aGlzLmRhdGEuZ2V0KF90aGlzLnJvbGUpLnZhbHVlKSAvIHRvdGFsICogMTAwIDw9IE51bWJlcihjaGlsZC5wYXJlbnRDdHguY2hpbGRyZW5bMV0uc3ltYm9sLnRleHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlKys7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgIj4iOgogICAgICAgICAgICAgICAgICAgICAgaWYgKE51bWJlcihfdGhpcy5kYXRhLmdldChfdGhpcy5yb2xlKS52YWx1ZSkgLyB0b3RhbCAqIDEwMCA+IE51bWJlcihjaGlsZC5wYXJlbnRDdHguY2hpbGRyZW5bMV0uc3ltYm9sLnRleHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlKys7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgIjwiOgogICAgICAgICAgICAgICAgICAgICAgaWYgKE51bWJlcihfdGhpcy5kYXRhLmdldChfdGhpcy5yb2xlKS52YWx1ZSkgLyB0b3RhbCAqIDEwMCA8IE51bWJlcihjaGlsZC5wYXJlbnRDdHguY2hpbGRyZW5bMV0uc3ltYm9sLnRleHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0YXRlKys7CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgIGNhc2UgIiE9IjoKICAgICAgICAgICAgICAgICAgICAgIGlmIChOdW1iZXIoX3RoaXMuZGF0YS5nZXQoX3RoaXMucm9sZSkudmFsdWUpIC8gdG90YWwgKiAxMDAgIT0gTnVtYmVyKGNoaWxkLnBhcmVudEN0eC5jaGlsZHJlblsxXS5zeW1ib2wudGV4dCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RhdGUrKzsKICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCJPcGVyYXRvciBub3QgbGVnYWwhIik7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiBjaGlsZC5nZXRUZXh0KCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBQcm9wZXJ0eVZpc2l0b3I7Cn0oKTs="},{"version":3,"sources":["/Users/xufei/Desktop/FlowModel/src/graph/propertyVisitor.js"],"names":["TimeContext","RoleContext","ExprContext","PropertyVisitor","endDay","data","nodes","state","Set","item","add","label","node","role","ctx","children","map","child","length","accept","console","log","parentCtx","tmpValue","symbol","text","parseInt","has","i","type","tmp","Map","j","set","total","Number","value","get","alert","getText"],"mappings":"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","sourcesContent":["import { TimeContext, RoleContext, ExprContext } from \"../parser/PropertyParser\";\nexport class PropertyVisitor {\n    constructor(endDay, data, nodes) {\n      this.state = 0;\n      this.endDay = endDay;\n      this.data = data;\n      this.nodes = new Set();\n      for (let item of nodes) {\n          this.nodes.add(item.label);\n      }\n      this.node = \"\";\n      this.role = \"\";\n    }\n  \n    visitChildren(ctx) {\n      \n      if (!ctx) {\n        return;\n      }\n  \n      if (ctx.children) {\n        return ctx.children.map(child => {\n          if (child.children && child.children.length != 0) {\n            return child.accept(this);\n          } else {\n            console.log(child);\n            // 当处理 Time 语法时 eg. \"After 100 days\"\n            if (child.parentCtx instanceof TimeContext) {\n                // Time 语法上下文中 下标为 1 的词是我们需要的\n                if (child == child.parentCtx.children[1]) {\n                    let tmpValue = child.symbol.text;\n                    // 判断测算模型测算的时间是否已达到 property 中规定的时间\n                    if (parseInt(tmpValue) <= this.endDay) {\n                        this.state++;\n                    }\n                }\n            } \n            // 当处理 Role 语法时 eg. \"AVAX.Token\"\n            else if (child.parentCtx instanceof RoleContext) {\n                if (child == child.parentCtx.children[0]) {\n                    // 判断 node 节点名称是否合法\n                    if (this.nodes.has(child.symbol.text)) {\n                        this.state++;\n                    }\n                    this.node = child.symbol.text;\n                    \n                }\n                if (child == child.parentCtx.children[2]) {\n                    this.role = child.symbol.text;\n                    // 根据已获取的 node 节点名字和 role 角色名字，保留测算数据中相关的部分数据\n                    for (let i = 0; i < this.data.length; i++) {\n                        // 找到 node 节点的数据\n                        if (this.data[i].type == this.node) {\n                            // 组装有效的数据\n                            let tmp = new Map();   // {type: \"Team\", data: {测算数据中最后一天的数据}}\n                            for (let j = 0; j < this.data[i].data.length; j++) {\n                                // 判断 role 名称是否合法\n                                if (this.role == this.data[i].data[j].type)\n                                    this.state++;\n                                tmp.set(this.data[i].data[j].type, this.data[i].data[j].data[this.data[i].data[j].data.length - 1]);\n                            }\n                            this.data = tmp;\n                            break;\n                        }\n                    }\n                    \n                }\n\n            }\n            else if (child.parentCtx instanceof ExprContext) {\n                if (child == child.parentCtx.children[0]) {\n                    // 计算当前 node 中所有 role 数值的总和，方便后续对不同 role 的占比进行计算\n                    let total = Number(0);\n                    for (let item of this.data) {\n                        total += Number(item[1].value);\n                    }\n                    switch (child.parentCtx.children[0].symbol.text) {\n                        case \">=\":\n                            // 计算当前 node 节点下 role 角色的数据占比是否满足 >= 的条件\n                            if (Number(this.data.get(this.role).value) / total * 100 >= Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        case \"==\":\n                            if (Number(this.data.get(this.role).value) / total * 100 == Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        case \"<=\":\n                            if (Number(this.data.get(this.role).value) / total * 100 <= Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        case \">\":\n                            if (Number(this.data.get(this.role).value) / total * 100 > Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        case \"<\":\n                            if (Number(this.data.get(this.role).value) / total * 100 < Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        case \"!=\":\n                            if (Number(this.data.get(this.role).value) / total * 100 != Number(child.parentCtx.children[1].symbol.text)) {\n                                this.state++;\n                            }\n                            break;\n                        default:\n                            alert(\"Operator not legal!\");\n                            break;\n                    }\n  \n                }\n                \n            }\n            return child.getText();\n          }\n        });\n      }\n    }\n  }"]}]}